/*
 * Copyright (c) 2025 Huawei Device Co., Ltd.
 * Licensed under the Apache License, Version 2.0(the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import { Decimal } from "@arkts.math.Decimal";

function main(): int {
    const suite = new arktest.ArkTestsuite("Decimal toFraction API tests");
    Decimal.set({ precision: 20, rounding: 4, toExpNeg: -9e15, toExpPos: 9e15, minE: -9e15, maxE: 9e15 });
    suite.addTest("Decimal toFraction with specific config", testToExponentialWithSpecificConfig001);
    suite.addTest("Decimal toFraction with specific config", testToExponentialWithSpecificConfig002);
    suite.addTest("Decimal toFraction with specific config", testToExponentialWithSpecificConfig003);
    suite.addTest("Decimal toFraction with specific config", testToExponentialWithSpecificConfig004);
    suite.addTest("Decimal toFraction with specific config", testToExponentialWithSpecificConfig005);
    suite.addTest("Decimal toFraction with specific config", testToExponentialWithSpecificConfig006);
    suite.addTest("Decimal toFraction with specific config", testToExponentialWithSpecificConfig007);
    suite.addTest("Decimal toFraction with specific config", testToExponentialWithSpecificConfig008);
    suite.addTest("Decimal toFraction with specific config", testToExponentialWithSpecificConfig009);
    suite.addTest("Decimal toFraction with specific config", testToExponentialWithSpecificConfig010);
    return suite.run();
}

function testToExponentialWithSpecificConfig001() {
    arktest.assertEQ(new Decimal('-6985335369519331.161674806985').toFraction().toString(), '-1397067073903866232334961397,200000000000');
    arktest.assertEQ(new Decimal('-1.082730014296142061458358296E+70').toFraction().toString(), '-10827300142961420614583582960000000000000000000000000000000000000000000,1');
    arktest.assertEQ(new Decimal('9769.57491658').toFraction().toString(), '488478745829,50000000');
    arktest.assertEQ(new Decimal('-9.278814552584579630569660716').toFraction().toString(), '-2319703638146144907642415179,250000000000000000000000000');
    arktest.assertEQ(new Decimal('8.199609').toFraction().toString(), '8199609,1000000');
    arktest.assertEQ(new Decimal('-22650405638418062.97933719282').toFraction().toString(), '-1132520281920903148966859641,50000000000');
    arktest.assertEQ(new Decimal('-943537244.8691264711').toFraction().toString(), '-9435372448691264711,10000000000');
    arktest.assertEQ(new Decimal('-5.430432705270926972283794348E+42').toFraction().toString(), '-5430432705270926972283794348000000000000000,1');
    arktest.assertEQ(new Decimal('254.7106921').toFraction().toString(), '2547106921,10000000');
    arktest.assertEQ(new Decimal('-8053444243730075.893216120196').toFraction().toString(), '-2013361060932518973304030049,250000000000');
}

function testToExponentialWithSpecificConfig002() {
    arktest.assertEQ(new Decimal('-74767843302323687781923.63575').toFraction().toString(), '-299071373209294751127694543,4000');
    arktest.assertEQ(new Decimal('32.2522').toFraction().toString(), '161261,5000');
    arktest.assertEQ(new Decimal('-2149015945426180798371334522').toFraction().toString(), '-2149015945426180798371334522,1');
    arktest.assertEQ(new Decimal('-975242046181.3569384841892184').toFraction().toString(), '-1219052557726696173105236523,1250000000000000');
    arktest.assertEQ(new Decimal('-6635702255618430700913.831019').toFraction().toString(), '-6635702255618430700913831019,1000000');
    arktest.assertEQ(new Decimal('-42290924109879729530570068.73').toFraction().toString(), '-4229092410987972953057006873,100');
    arktest.assertEQ(new Decimal('8008767579580873470979426873.32875742929708200305858327085977609').toFraction().toString(), '800876757958087347097942687332875742929708200305858327085977609,100000000000000000000000000000000000');
    arktest.assertEQ(new Decimal('-53309687933410961482738903.86').toFraction().toString(), '-2665484396670548074136945193,50');
    arktest.assertEQ(new Decimal('0.79581097').toFraction('74409').toString(), '30396,38195');
}

function testToExponentialWithSpecificConfig003() {
    arktest.assertEQ(new Decimal('646110.5424140842277760913716223149175043516912866283522989430448583852673477181054').toFraction('4314').toString(), '2125057574,3289');
    arktest.assertEQ(new Decimal('1140.688086121119279582816178812726653910').toFraction('37').toString(), '18251,16');
    arktest.assertEQ(new Decimal('30674382513540892238116444815711309458620542801128.559859020834676491532682063017825303001913079937413732204504474950978211332225018371420').toFraction('2').toString(), '61348765027081784476232889631422618917241085602257,2');
    arktest.assertEQ(new Decimal('9174193129457486826033417691391647830796882006449660.0558100148468970808679278895365813792370050009058167954469').toFraction('61710').toString(), '238354711696434965227174225040046402291933791409568617910,25981');
    arktest.assertEQ(new Decimal('919495974905217288703595469354435393822802085980318046767.1338999658963927824509929378965804777221331548975659545056488845295998946309871474144010438').toFraction('9').toString(), '7355967799241738309628763754835483150582416687842544374137,8');
    arktest.assertEQ(new Decimal('4547237716782743755943866989.8356560705677241346146759866583370949').toFraction('863202').toString(), '1125354937387110207464744146511518,247481');
    arktest.assertEQ(new Decimal('6684320.09797413893379904985072385250774250364224704531308514779353223').toFraction('14426').toString(), '58400904696,8737');
    arktest.assertEQ(new Decimal('9889359.28886025414277').toFraction('551989').toString(), '4765998700799,481932');
    arktest.assertEQ(new Decimal('84446319074008288318841993796319916.4290214679797552828327089099139280188').toFraction('1').toString(), '84446319074008288318841993796319916,1');
    arktest.assertEQ(new Decimal('7192411578339741566080.621098672624218880520368888346887640903578755437931806539999680994582938').toFraction('38').toString(), '208579935771852505416338,29');
}

function testToExponentialWithSpecificConfig004() {
    arktest.assertEQ(new Decimal('3005559325061644218561964167641260035161858920552843936039505077.70447752609278095294701366298104650604976387611568135143174113323780682').toFraction('7063').toString(), '1006862373895650813218257996159822111779222738385202718573234201031,335');
    arktest.assertEQ(new Decimal('41932.7940043445804168810482554121918927813650259').toFraction('895566').toString(), '12180512204,290477');
    arktest.assertEQ(new Decimal('53541607836.080957621939096312239677792878740188648258030024875').toFraction('31555').toString(), '972851014381591,18170');
    arktest.assertEQ(new Decimal('6501295322096.01707059843465672720153308').toFraction('88').toString(), '383576424003665,59');
    arktest.assertEQ(new Decimal('623290.372447884850674344473049816049238992052574671').toFraction('770999').toString(), '456059695649,731697');
    arktest.assertEQ(new Decimal('0.5716202415873544262986953173753852278285193332218646822626651').toFraction('2').toString(), '1,2');
    arktest.assertEQ(new Decimal('5470634478750193005701111314607953627282253109963257869896225013864965536493.782798186996737913044082377221550214034629772236938011947896897722075720890727218714').toFraction('2580').toString(), '13802410789886736953383903846755867001633124596437299605748175709981308048573814,2523');
    arktest.assertEQ(new Decimal('1720546690653497270570006270472130851.14006845543964920673232647491053082791301585407937041734157349507526701334664232654756777642845206').toFraction('1').toString(), '1720546690653497270570006270472130851,1');
    arktest.assertEQ(new Decimal('43917221872024973437243762385431.5005579559793624838126175850466341579997661657132448932942532299').toFraction('11453').toString(), '275492732803212658371830121443811803,6273');
    arktest.assertEQ(new Decimal('946380134802740069071108764912367186554505.02139414761736578247940104106009403877307019264568966335689948628094').toFraction('100').toString(), '88013352536654826423613115136850148349568967,93');
    arktest.assertEQ(new Decimal('0.16188799510329961').toFraction('2').toString(), '0,1');
    arktest.assertEQ(new Decimal('496155200156912588508379320070503930908190489069266499.364683462978985476107209780379101750930177884309470340386147403736530').toFraction('73').toString(), '31257777609885493076027897164441747647216000811363789460,63');
}

function testToExponentialWithSpecificConfig005() {
    arktest.assertEQ(new Decimal('-59838206470642867345.02864922').toFraction().toString(), '-2991910323532143367251432461,50000000');
    arktest.assertEQ(new Decimal('-9.727452008639720390120442885E+56').toFraction().toString(), '-972745200863972039012044288500000000000000000000000000000,1');
    arktest.assertEQ(new Decimal('-7.59').toFraction().toString(), '-759,100');
    arktest.assertEQ(new Decimal('-278272581514524949348632.0100').toFraction().toString(), '-27827258151452494934863201,100');
    arktest.assertEQ(new Decimal('-5692.53601618').toFraction().toString(), '-284626800809,50000000');
    arktest.assertEQ(new Decimal('-930270790.1030908648560428875').toFraction().toString(), '-74421663208247269188483431,80000000000000000');
    arktest.assertEQ(new Decimal('-1.082016448333999416859837516E+30').toFraction().toString(), '-1082016448333999416859837516000,1');
    arktest.assertEQ(new Decimal('-0.84').toFraction().toString(), '-21,25');
    arktest.assertEQ(new Decimal('-8405819271711162542.005901375').toFraction().toString(), '-67246554173689300336047211,8000000');
    arktest.assertEQ(new Decimal('-2.196812392790282979771359770E+39').toFraction().toString(), '-2196812392790282979771359770000000000000,1');
}

function testToExponentialWithSpecificConfig006() {
    arktest.assertEQ(new Decimal('-9.336763844064577288340288931E+31').toFraction().toString(), '-93367638440645772883402889310000,1');
    arktest.assertEQ(new Decimal('-3.598919971327247089389639764E+37').toFraction().toString(), '-35989199713272470893896397640000000000,1');
    arktest.assertEQ(new Decimal('-2.164121368433393987617956904E+28').toFraction().toString(), '-21641213684333939876179569040,1');
    arktest.assertEQ(new Decimal('-9.130912769213956601432703922E+64').toFraction().toString(), '-91309127692139566014327039220000000000000000000000000000000000000,1');
    arktest.assertEQ(new Decimal('-39828889546453238.24200113918').toFraction().toString(), '-1991444477322661912100056959,50000000000');
    arktest.assertEQ(new Decimal('-55.35158656167491485055927810').toFraction().toString(), '-553515865616749148505592781,10000000000000000000000000');
    arktest.assertEQ(new Decimal('-5473307660200784975387.242062').toFraction().toString(), '-2736653830100392487693621031,500000');
    arktest.assertEQ(new Decimal('-286982155661917456.2799154218').toFraction().toString(), '-1434910778309587281399577109,5000000000');
    arktest.assertEQ(new Decimal('0.7325643').toFraction().toString(), '7325643,10000000');
    arktest.assertEQ(new Decimal('81297534687091521.91211051855224273832281').toFraction().toString(), '8129753468709152191211051855224273832281,100000000000000000000000');
    arktest.assertEQ(new Decimal('4023214922452471497.25630571786057289667012386513324609').toFraction('72150416').toString(), '26846080372036394639591396,6672793');
    arktest.assertEQ(new Decimal('755847.328153061897408378264066684087805946605').toFraction().toString(), '151169465630612379481675652813336817561189321,200000000000000000000000000000000000000');
    arktest.assertEQ(new Decimal('48650152878444478499756261.104359').toFraction().toString(), '48650152878444478499756261104359,1000000');
}

function testToExponentialWithSpecificConfig007() {
    arktest.assertEQ(new Decimal('98942665638509321.1423434879780971949357099446690852').toFraction('4194429').toString(), '310291026486294288245548,3136069');
    arktest.assertEQ(new Decimal('9953232194581201656.11264913171363754779711915').toFraction('40003').toString(), '281148949800335203180214,28247');
    arktest.assertEQ(new Decimal('807099173.7').toFraction().toString(), '8070991737,10');
    arktest.assertEQ(new Decimal('842335058998719134097422.1715979897462986201981036').toFraction().toString(), '2105837647496797835243555428994974365746550495259,2500000000000000000000000');
    arktest.assertEQ(new Decimal('70505494067154490.07260719040610995681').toFraction().toString(), '7050549406715449007260719040610995681,100000000000000000000');
    arktest.assertEQ(new Decimal('14855216399811587657145.09531187624755829128849').toFraction().toString(), '1485521639981158765714509531187624755829128849,100000000000000000000000');
    arktest.assertEQ(new Decimal('451374367873296470301265441541162556657.33752912').toFraction('654').toString(), '179195624045698698709602380291841534992963,397');
    arktest.assertEQ(new Decimal('750455321520.1975303545477874468301224681956212').toFraction('6955').toString(), '60786881043136,81');
    arktest.assertEQ(new Decimal('489640170686365547452689.9639497075875189553277274425649764720088').toFraction('136').toString(), '54350058946186575767248586,111');
    arktest.assertEQ(new Decimal('82979325.34128477517548246164389960').toFraction().toString(), '207448313353211937938706154109749,2500000000000000000000000');
    arktest.assertEQ(new Decimal('931866401.54478486865').toFraction().toString(), '18637328030895697373,20000000000');
}

function testToExponentialWithSpecificConfig008() {
    arktest.assertEQ(new Decimal('7712723080.8472816894238711').toFraction().toString(), '77127230808472816894238711,10000000000000000');
    arktest.assertEQ(new Decimal('4160881936704043602173554309387122294.5709328').toFraction('7').toString(), '29126173556928305215214880165709856062,7');
    arktest.assertEQ(new Decimal('70518843391393.531604308619475952242596538499476346').toFraction('675048').toString(), '43333053556734019842,614489');
    arktest.assertEQ(new Decimal('95445.231562915140439462747444833608100863907').toFraction('1363996915').toString(), '53377793855957,559250504');
    arktest.assertEQ(new Decimal('299.9045833667611513140004251012084').toFraction('3206002475').toString(), '347448038601,1158528605');
    arktest.assertEQ(new Decimal('47235590253929.92686163722415183139').toFraction().toString(), '4723559025392992686163722415183139,100000000000000000000');
    arktest.assertEQ(new Decimal('98328691470714782625004163686209.3533896422549273776361277').toFraction('1811232885').toString(), '178091379773085237300450763077988415217238,1811184275');
    arktest.assertEQ(new Decimal('8055147248313052044208741856994.45105715750883').toFraction().toString(), '805514724831305204420874185699445105715750883,100000000000000');
    arktest.assertEQ(new Decimal('9.610016056348').toFraction('8529').toString(), '65819,6849');
}

function testToExponentialWithSpecificConfig009() {
    arktest.assertEQ(new Decimal('510670028720980.0871365544559472').toFraction().toString(), '319168767950612554460346534967,625000000000000');
    arktest.assertEQ(new Decimal('64170.7336772078034895641687140263').toFraction('92775').toString(), '5710296907,88986');
    arktest.assertEQ(new Decimal('1113176727893004996666617450271972.102427360371078853103050428478489704402').toFraction().toString(), '556588363946502498333308725135986051213680185539426551525214239244852201,500000000000000000000000000000000000000');
    arktest.assertEQ(new Decimal('666459967364703414254713245.421153056').toFraction().toString(), '20826873980146981695459788919411033,31250000');
    arktest.assertEQ(new Decimal('2499361049528080561.202511540068978284974386343138634241').toFraction().toString(), '2499361049528080561202511540068978284974386343138634241,1000000000000000000000000000000000000');
    arktest.assertEQ(new Decimal('8365976145105381170540384726.81972262078895455779223713273658154').toFraction().toString(), '418298807255269058527019236340986131039447727889611856636829077,50000000000000000000000000000000000');
    arktest.assertEQ(new Decimal('69133242753235376897.24784638569909').toFraction().toString(), '6913324275323537689724784638569909,100000000000000');
    arktest.assertEQ(new Decimal('6981191730187792647202564832506918.8165').toFraction().toString(), '13962383460375585294405129665013837633,2000');
}

function testToExponentialWithSpecificConfig010() {
    arktest.assertEQ(new Decimal('123.45').toFraction().toString(), '2469,20');
    arktest.assertEQ(new Decimal('123.45').toFraction('2.1e1').toString(), '2469,20');
    arktest.assertEQ(new Decimal('123.45').toFraction(new Decimal(10)).toString(), '1111,9' );
    arktest.assertEQ(new Decimal('123.45').toFraction(new Decimal('123e399')).toString(), '2469,20');
    arktest.assertEQ(new Decimal('123.45').toFraction(new Decimal('123')).toString(), '2469,20');
}
