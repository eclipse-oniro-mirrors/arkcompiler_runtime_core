/*
 * Copyright (c) 2025 Huawei Device Co., Ltd.
 * Licensed under the Apache License, Version 2.0(the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import { Decimal } from "@arkts.math.Decimal";

function main(): int {
    const suite = new arktest.ArkTestsuite("Decimal ln API tests");
    suite.addTest("Decimal ln with specific config", testLnWithSpecificConfigPart001);
    suite.addTest("Decimal ln with specific config", testLnWithSpecificConfigPart002);
    suite.addTest("Decimal ln with specific config", testLnWithSpecificConfigPart003);
    suite.addTest("Decimal ln with specific config", testLnWithSpecificConfigPart004);
    suite.addTest("Decimal ln with specific config", testLnWithSpecificConfigPart005);
    return suite.run();
}

function checkLnResult(n: string, expected: string, sd: number, rm: number) {
    Decimal.precision = sd;
    Decimal.rounding = rm;
    arktest.assertEQ(new Decimal(n).ln().valueOf(), expected);
}

function testLnWithSpecificConfigPart001() {
    Decimal.set({ precision: 40, rounding: 4, toExpNeg: -9e15, toExpPos: 9e15, minE: -9e15, maxE: 9e15 });
    checkLnResult('0', '-Infinity', 40, 4);
    checkLnResult('0', String(Math.log(0)), 40, 4);
    checkLnResult('-0', String('-Infinity'), 40, 4);
    checkLnResult('-0', String(Math.log(-0)), 40, 4);
    checkLnResult('1', '0', 40, 4);
    checkLnResult('1', String(Math.log(1)), 40, 4);
    checkLnResult('-Infinity', 'NaN', 40, 4);
    checkLnResult('-Infinity', String(Math.log(-Infinity)), 40, 4);
    checkLnResult('Infinity', 'Infinity', 40, 4);
    checkLnResult('Infinity', String(Math.log(Infinity)), 40, 4);
    checkLnResult('NaN', 'NaN', 40, 4);
    checkLnResult('NaN', String(Math.log(NaN)), 40, 4);
    checkLnResult('2.7182818284590452353602874713526624977572', '1', 39, 4);

    checkLnResult('91247532.65728', '18.3290865106890306', 19, 1);
    checkLnResult('727579403.9', '20.40523369730819818291393006', 28, 3);
    checkLnResult('419065154.52076499608', '19.8535369658470908', 19, 2);
    checkLnResult('130749452.494110812', '18.68879347348', 13, 6);
    checkLnResult('1185619573.5511384009507900359', '20.89353132177529891789', 22, 0);
    checkLnResult('530465273.44', '20.089265053819159', 17, 4);
    checkLnResult('93521824.19043496087', '18.353705380823595707150211318', 29, 3);
    checkLnResult('93587439.79738005953', '18.354406742245', 14, 0);
    checkLnResult('913009834.17782778193371741', '20.63225720978034314683755252', 29, 4);
    checkLnResult('96363417.9729392663575231665', '18.3836372059508935007674191717', 30, 0);
    checkLnResult('210401674.5643546532430157', '19.1645289977522148145584372801492541489626022147443118341', 57, 3);
    checkLnResult('952417276.8651321118737418', '20.67451381275802954644121920485653995422386303532469652920020456933991073071', 76, 3);
}

function testLnWithSpecificConfigPart002() {
    checkLnResult('142322563.253900033190831713543268828109981967888490291406527346535501984011990242137300064766425179727442507442591862989037644368590904104621357145575632132596634560836335843482822061685451360570260600926717066081883739008412790434377893984866700040372917562269733068809727985812968781985268403920729907489962116060023323078359102582924017315196797171078484331048743611378544575282691634826207', '18.77360661165643483904346', 25, 4);
    checkLnResult('371400293.53826507744653292410472631048281764405036030167939649508120465472946573115185753424640793913438158589233749086894500415028950753895660006551599374916249772634013307822672548085573611750200419176163913242813545244921337312493040312898991903677477383181667469789752847529551033664230833747974881304800992388176411266053764', '19.732790997238693', 17, 5);
    checkLnResult('308061625.88823978041274039804998186206865791141980152103127270513511076834989316028752984249313112128128502539231626511285494530858340408577571344790765131399576822101736125139886541136712372342853393859483419254236049454263746814598084065516321822244266672902276617353573868701264411419113453133557772924904083715036037838173144284202571542029689590647862395', '19.5', 3, 4);
    checkLnResult('56166207.244290436722984261495400654889250285124533321022981475832539124544579218170536475258779537248807554699941937121725987852537935501915601362', '17.8438258394282509999', 21, 6);
    checkLnResult('222624724.707607328646707303867967259139519139629423079746317622391060720425657380049896682204826804719116517331792375328854607227578421004813898208914187979742668659057386237112777304292626154363413399007128375956303978756008642562104282496678212208286912567720592497594790267585324990906417857716073248926170009724869749739256517', '19.2209980629988594846457575', 27, 0);
    checkLnResult('185258598.8193913934519764713459928878217005284578212999298749640634191497175066526732902777761314076480735321777689520905932035413871290869941575745986362030629539', '19.03726323844184819241728391212796712905475895', 46, 3);
    checkLnResult('269693209.738329262863103619932258583418154544819938948520850885129975757878155942909813913575593873613967345697983513739799036745044974770565058447912595936725318596664619637466457786273308379783363276858754429871221986504763671381169376146393662591214420480616860804709987497567541966840009610585879458456647716651843692095645431144825029791181857768800342074145503590855886070320931830102002860548331131946643428330049680453526744262227', '19.4128', 6, 2);
    checkLnResult('1023342793.682203550119853590855855440825349592189658219400017324862237829261909743084375742003621225707754353154890001299178609037775929182416', '20.7', 3, 4);
    checkLnResult('288066409.930742086163569035868595871340060157483817829526835857178700227646660208478255306458767689905569779533532613990984463726169225', '19.4787016015557225466209307245195728148', 39, 6);
    checkLnResult('659962551.7196736389816108624246917556391933488125636501841767846136469655007635589597690345289565290187266991221823977105182413305954975153418768184526414022291854836356848438340284898272452919407497723633962181806929526702888572755311195630908175133297801595820610915241491322973994939537556926297001075794108221345170572608247217166782978965314275924298103649904183225053518681061802488451326', '20.307693651556304624603', 23, 2);
    checkLnResult('1507364652.7412807014310450849045388639397320237966928257974087635919752464931336652652563316012320514301796477028177198948086347984093073988211028197354698778354347658908468312563297806615829593697914663744507730778747959075016883455899218807867027301117084501104764662133718266594886462034333606057118803676760138265831276687149773555531764176520964444746495235029665718222485165667080758798726878577774041717453053559075165574861878572784439577325279859720699815', '21.133628699942067740343303809380556857137955185', 47, 5);
    checkLnResult('390145000.967298821818782016684792033527978825236257109725032636684195216173865101534596314015627154955417417356051726409514707961291776124601310897', '19.782029025340505793950028597475307602798983116', 47, 1);
    checkLnResult('1582186416.193367134722504736788921341001732540902935815137028669849087377143230724513115136185091885228053584573993361147951779854091136019178181014965525402328169438038737972227467851264', '21.18207353512', 13, 1);
    checkLnResult('444181511.379330635761040379043896319', '19.9117438462696047845568005370964420406847915', 45, 2);
    checkLnResult('1649165442.81508159186866091659911601847915727898761380479217148722967003628844958192423020437941929274541019164440472673454567347131337845196944956123772899539516241995922964069898844748283940385593209556832209762517653421012964293705687275161487307996022854435621786593342404292930985767687391343569565159759022658057195057590383081972675845225107300959105018192214115690180632353307', '21.223535204669576956240210909820794512745', 41, 5);
    checkLnResult('956193088.33977562292786906645507064275401232361020165960269744050571700135755870903976551991970971401541090373022939626590186869869098847675469870075789885973042670437758904496341260362989490245294442892663605116104481315514350394492341667402397008571518074733491886421982724176798753763402802355543297381889941871793636978236549161242963426659386692353226535780947411516134695241409391848436453976510684', '20.678470425872231784432536313273269750899620287', 47, 6);
    checkLnResult('524656579.6561082202986522788989992058097028959478133491616251386650273315481201712733337497961653741466850177948', '20.07825447252854998238544895', 28, 1);
    checkLnResult('412184042.8896878204667114461794718285421610397268782502943123737616921059160330553262782457035088179494074564563410048773731594742762676033110116212190491442443442166045598309788282584460671280467345157657971668722189192696185094311918310776057781011454221034130478455744396828404806478740586228712397995429199362271635020780002483852222338852479130612370279841990621710882872848128725669571603659740938524254161291050199148884609411958653228755273145468', '19.83698051361329059', 19, 5);
    checkLnResult('54177615.4161615199898039376707204324649188748836298320352749128620609118474310429998270745885186642610341190928928278585051565238331611651463560104044550438095405103019768593446391808685915870067181972775276870790595322163624212767962894314519491376965719216779872096909267426650844863008221945010966830813924747797605343830807190598639058151734866383440974952571052161557282681608575287009214045591019', '17.807779', 8, 0);
    checkLnResult('202208538.0186996731425487962109425863325508616918249176043925148428750848485730129706779656165064759679330957399949664528408543769938770452288279928848232018815279096218064756460984277961961770343996043873166572208624824439463192886927974622714849727874835303030139509530094904609301858682577824229369378223655885781140501472159022060380707281531318049222808388638845419183185', '19.124810089270938003831849629', 29, 4);
    checkLnResult('419077532.2448607619101987942607612824719743129742324423040412531483957695007192401517535342220366141599584852033167948744863351374575147495928944631030285526934314990168106650729902570735596692781194661598925404746581114061618262181809902436423306258562179673075380899236033671', '19.85356650192559415566417', 25, 3);
    checkLnResult('146708483.32674399300686866605976073019721421720619119889933263331964327217855614280622971093931911986466782717253122036096979367739887439449073138969919020714899901453823470883487750734885842377270384469297548135028684586032301609167142204835412029755367943305773471371240556395996807312138338709086180854612022228560209117316657640810924077420852085218504347155816788970471703339876', '18.803958069162751518238485267', 29, 5);
}

function testLnWithSpecificConfigPart003() {
    checkLnResult('1.0000000000000000000000000000000000000000000000000001230000000000756', '0.000000000000000000000000000000000000000000000000000123', 3, 1);
    checkLnResult('1.0000000000000000000000000000000000000000000000000001230000000000756', '0.000000000000000000000000000000000000000000000000000123', 3, 1);
    checkLnResult('1.0000000000000000000000000000000000000000000000000001230000000000756', '0.0000000000000000000000000000000000000000000000000001230000000000756', 16, 0);
    checkLnResult('1.0000000000000000000000000000000000000000000000000001230000000000756', '0.0000000000000000000000000000000000000000000000000001230000000000755', 16, 1);
    checkLnResult('1.0000000000000000000000000000000000000000000000000001230000000000756', '0.00000000000000000000000000000000000000000000000000012300000000007559', 17, 1);
    checkLnResult('1.0000000000000000000000000000000000000000000000000001230000000000756', '0.0000000000000000000000000000000000000000000000000001230000000000755999999999999999999999999999999999999924354999999907011999999971423201', 85, 0);
    checkLnResult('1.0000000000000000000000000000000000000000000000000001230000000000756', '0.00000000000000000000000000000000000000000000000000012300000000007559999999999999999999999999999999999999243549999999070119999999714232', 83, 1);

    checkLnResult('1.000000001230000000756', '0.00000000122', 3, 1);
    checkLnResult('1.000000001230000000756', '0.00000000122999', 6, 1);
    checkLnResult('1.000000001230000000756', '0.00000000122999999999954', 15, 1);
    checkLnResult('0.9999999', '-0.0000001000000050000003333333583333353333335000000142857155357144', 58, 3);

    checkLnResult('0.999', '-0.001000500333583533500142983', 25, 0);
    checkLnResult('0.99', '-0.0100503358536', 12, 3);
    checkLnResult('1.0000000000001', '0.00000000000009999999999999501', 16, 2);
    checkLnResult('1.0000000000001', '0.0000000000000999999999999951', 15, 2);
    checkLnResult('1.0000000000001', '0.000000000000099999999999996', 14, 2);
    checkLnResult('1.00000000000001', '0.00000000000000999999999999996', 15, 2);
    checkLnResult('1.000000000000000000000000000000000000001', '0.0000000000000000000000000000000000000009999999999999999999999999999999999999995000001', 46, 0);

    checkLnResult('8.1', '2.09186', 6, 1);
    checkLnResult('39.6', '3.67883', 7, 2);
    checkLnResult('13.83', '2.62684015', 9, 4);
    checkLnResult('46.7', '4', 1, 0);
    checkLnResult('47.9', '4', 1, 4);
    checkLnResult('98.9', '4.59410924', 9, 4);
    checkLnResult('28.1', '3.33576957', 9, 3);
}

function testLnWithSpecificConfigPart004() {
    checkLnResult('19.4', '2.9652731', 8, 0);
    checkLnResult('1.8', '0.587786665', 9, 4);
    checkLnResult('63.8', '4', 1, 4);
    checkLnResult('3.5', '1.25276296', 9, 3);
    checkLnResult('72.91', '5', 1, 2);
    checkLnResult('7.54', '2.020223', 7, 0);
    checkLnResult('61.1', '4.11251186', 9, 3);
    checkLnResult('64.3', '4.16', 3, 4);
    checkLnResult('70.4', '4.26', 3, 0);
    checkLnResult('40.34', '3.6973435', 8, 1);
    checkLnResult('97.56', '4.580468', 7, 0);
    checkLnResult('4.2', '1.4350845', 8, 1);
    checkLnResult('14.23', '2.65535', 6, 1);
    checkLnResult('21.41', '3.06', 3, 1);
    checkLnResult('86.5', '4.46014', 6, 3);
    checkLnResult('53.5', '3.97968', 6, 4);
    checkLnResult('41.2', '4', 1, 4);
    checkLnResult('22.67', '3.121', 4, 1);
    checkLnResult('39.1', '3.666122466', 10, 1);
    checkLnResult('20.8', '3.035', 4, 0);
    checkLnResult('27.72', '3.3221541743', 11, 3);
    checkLnResult('484260633.26', '19.9981', 6, 1);
    checkLnResult('739084458.57', '20.420922760027607325270794371574372', 35, 3);
    checkLnResult('173897238.6257338023989', '18.9739751001054747115892', 24, 0);
    checkLnResult('234294644.588885865140275679', '19.2720900461484484624992', 24, 6);
    checkLnResult('663446355.03930603', '20.312', 5, 3);
    checkLnResult('236924096.650141980105861288', '19.2832503', 9, 1);
}

function testLnWithSpecificConfigPart005() {
    checkLnResult('383519031.802423', '19.7648998041', 12, 3);
    checkLnResult('495413774.3180056262693', '20.02090387906982718762754628426', 31, 0);
    checkLnResult('103272854.9147823146420226558', '18.4528851204168398068299228814439335', 36, 2);
    checkLnResult('1255876919.801289301817086', '20.9510999', 9, 4);
    checkLnResult('892565379.904099781', '20.6096103237295763729453899449191', 33, 5);
    checkLnResult('714436577.20394836', '20.38700479', 10, 2);
    checkLnResult('114209899', '18.5535', 6, 6);
    checkLnResult('11138070.731145', '16.225879593546584', 17, 1);
    checkLnResult('173982352.98970322915408', '18.9744644324360810729339336092249432', 36, 0);
    checkLnResult('601898865.418395208648', '20.2155999915160485142287883', 27, 2);
    checkLnResult('1737398240.940989286501485', '21.3', 3, 5);
    checkLnResult('1223195313.271302839406', '20.93', 4, 2);
    checkLnResult('483960664.70757792519406292', '19.9975141901128827175535702', 27, 0);
    checkLnResult('254561643.88559655966887725', '19.35505359', 10, 0);
    checkLnResult('230901371.26208883297662', '19.25750121307751', 16, 2);
    checkLnResult('39049637.3708272077470901', '17.480344148', 11, 5);
    checkLnResult('605727.08861135233', '13.314184814787811646051719561794', 32, 5);
    checkLnResult('110166953.414692391364862', '18.51750753144102983720945609400314449', 37, 3);
    checkLnResult('341161100.758980208051', '19.6478653599282687781757344218', 31, 4);
    checkLnResult('316912316.269705411968295', '19.57413568875', 13, 1);
    checkLnResult('1471705773.129049604979506', '21.1096879548887928212', 21, 2);
    checkLnResult('43608215.24072301429834', '17.6', 4, 0);
    checkLnResult('692035632.3', '20.3551480040192941281921918635691', 33, 4);
    checkLnResult('437966495.9954174972446009', '19.9', 3, 2);
    checkLnResult('1021072161.39012', '20.74411905080098544439092', 25, 0);
    checkLnResult('420919239.137', '19.85795154221623', 16, 2);
    checkLnResult('1478634317.69367498567837', '21.114384740403810652547', 23, 3);
}
