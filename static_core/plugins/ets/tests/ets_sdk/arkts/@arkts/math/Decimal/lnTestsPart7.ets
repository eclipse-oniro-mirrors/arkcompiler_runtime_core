/*
 * Copyright (c) 2025 Huawei Device Co., Ltd.
 * Licensed under the Apache License, Version 2.0(the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import { Decimal } from "@arkts.math.Decimal";

function main(): int {
    const suite = new arktest.ArkTestsuite("Decimal ln API tests part 7");
    suite.addTest("Decimal ln with specific config", testLnWithSpecificConfigPart001);
    suite.addTest("Decimal ln with specific config", testLnWithSpecificConfigPart002);
    suite.addTest("Decimal ln with specific config", testLnWithSpecificConfigPart003);
    suite.addTest("Decimal ln with specific config", testLnWithSpecificConfigPart004);
    return suite.run();
}

function checkLnResult(n: string, expected: string, sd: number, rm: number) {
    Decimal.precision = sd;
    Decimal.rounding = rm;
    arktest.assertEQ(new Decimal(n).ln().valueOf(), expected);
}

function testLnWithSpecificConfigPart001() {
    Decimal.set({ precision: 40, rounding: 4, toExpNeg: -9e15, toExpPos: 9e15, minE: -9e15, maxE: 9e15 });
    checkLnResult('0.999997999999399997999993999949', '-0.000002000002600005866683246750786841565741132', 40, 4);
    checkLnResult('0.999999999999999999929929999997999979999999929799', '-0.00000000000000000007007000000200002000245497265114014', 34, 4);
    checkLnResult('0.08000009', '-2.5257275193088882518096775704454984610695', 41, 3);
    checkLnResult('0.00090400000000000000000004060600070700000809', '-7.0086811975720976072740759519732589', 35, 4);
    checkLnResult('0.000704006', '-7.25872367911527720999907560001613988913676912731866147366599498415', 66, 1);
    checkLnResult('0.08', '-2.52572864430825543979', 21, 0);
    checkLnResult('0.9999999929999199999499999999999999799999499', '-0.0000000070000800245505601178872580008623040894857280221937339', 53, 0);
    checkLnResult('0.99499998999694996999999999999999999397999299999', '-0.0050125518769', 11, 3);
    checkLnResult('0.0000000000020000007000005000002', '-26.93787358536841414877187370746409029977817', 43, 0);
    checkLnResult('0.009000002000002', '-4.71053048', 10, 0);
    checkLnResult('0.03000004', '-3.5065565639875372314061705613342488', 36, 2);
}

function testLnWithSpecificConfigPart002() {
    checkLnResult('0.1754385964912280701754385965', '-1.74046617484051', 15, 3);
    checkLnResult('6.0', '1.791759469228055', 16, 6);
    checkLnResult('0.5', '-0.6931471805599453', 17, 2);
    checkLnResult('2.5', '0.91', 2, 1);
    checkLnResult('0.142857', '-1.94591114905582', 15, 3);
    checkLnResult('0.4545454545454545454', '-0.788457360364270169', 18, 2);
    checkLnResult('0.05', '-2.995732273553990993', 19, 2);
    checkLnResult('9.0', '2.1972245773362194', 17, 6);
    checkLnResult('2.0', '0.693147180559945', 15, 1);
    checkLnResult('0.02132196162046908315', '-3.84801767545223368', 18, 4);
    checkLnResult('0.1063829787234042553191', '-2.2407096893', 11, 0);
    checkLnResult('2.7', '0.9932518', 7, 0);
    checkLnResult('0.013440860215', '-4.3094559418430461815', 20, 1);
}

function testLnWithSpecificConfigPart003() {
    checkLnResult('0.0107526881720430107526881', '-4.53259', 6, 2);
    checkLnResult('0.03125', '-3', 1, 5);
    checkLnResult('2.3', '0.8329', 4, 4);
    checkLnResult('0.015151515', '-4.18965475203', 12, 5);
    checkLnResult('0.01162790697674418', '-4.45434729626', 12, 0);
    checkLnResult('0.01584786053882725', '-4.1447207695471679983', 20, 3);
    checkLnResult('9.3', '2.2300144001', 11, 3);
    checkLnResult('36.0', '3.5835', 5, 3);
    checkLnResult('0.0111111111', '-4.4998096713302', 14, 2);
    checkLnResult('2.8', '1.1', 2, 2);
    checkLnResult('9.0', '2.197224577336219', 16, 3);
    checkLnResult('0.011363636363636363636', '-4.4', 2, 2);
    checkLnResult('70.0', '4.248495242', 11, 1);
    checkLnResult('0.0111111111111111', '-4.49980967033', 12, 5);
    checkLnResult('4.0', '1.39', 3, 5);
    checkLnResult('0.01117318', '-4.49423901528089', 15, 5);
    checkLnResult('0.2', '-1.60943791243410038', 18, 3);
    checkLnResult('0.2941176470588235294117', '-1.2237754316221157056', 20, 5);
    checkLnResult('25.0', '3.218875824868200749', 19, 4);
    checkLnResult('0.19230769230769230769230', '-1.64865862558738168', 18, 3);
    checkLnResult('35.0', '3.5553480614', 11, 3);
    checkLnResult('50.0', '3.9120230054281460586', 20, 5);
    checkLnResult('0.0241545893719806763285024', '-3.7233', 5, 4);
    checkLnResult('12.0', '2.484906', 7, 3);
    checkLnResult('0.077519379844', '-2.55722731138003', 15, 0);
    checkLnResult('78.9', '4', 1, 6);
    checkLnResult('4.9', '1.589235205116580927', 19, 2);
    checkLnResult('59.8', '4.091005660956586', 16, 1);
    checkLnResult('4.2', '1.43509', 6, 0);
    checkLnResult('0.02', '-3.9121', 5, 3);
    checkLnResult('60.0', '4.09', 3, 1);
    checkLnResult('0.7692307', '-0.26236435', 8, 2);
    checkLnResult('0.333333333333', '-1.09861228866911', 15, 0);
    checkLnResult('0.02732240437158469945', '-3.600048240407', 13, 5);
    checkLnResult('0.061728395061728395', '-2.8', 2, 6);
    checkLnResult('8.0', '2.07944154', 9, 5);
}

function testLnWithSpecificConfigPart004() {
    checkLnResult('0.9999999999999999999999999999999999999568192301488826794261698690972956411635111284787367786816502083882422798578731605252106199479075698', '-0.00000000000000000000000000000000000004318076985111732057383013090270435884', 37, 4);
    checkLnResult('0.9999999999999999999999979550666058305047704469654544926170385722676726565280928302935213393351515069436413391635857924053031503612857234287', '-0.000000000000000000000002044933394169495', 16, 6);
    checkLnResult('0.9999999999999999999999999999788589934323601088222420429829335393675583983311669404940044418555472559469792115593688854910667629732945617', '-0.000000000000000000000000000021141006567639891177757', 23, 2);
    checkLnResult('0.99999965612996150232225742078449327047019615530457466722741143133687180033806758021000178033650121765045177844535360974813202360649705716806472085515573024723452129710679277030691649', '-0.00000034387009762099298460124920225891418549479847', 44, 3);
    checkLnResult('0.999999999999999999998', '-0.000000000000000000002', 11, 6);
    checkLnResult('0.99998389456495199790866464051967145510973599943414379845553913640458143099808775839406749813252', '-0.0000161055647419136538238914419840240365', 36, 5);
    checkLnResult('1.000000000000000000000000000000000000000002453877989156637807977474490521127775312951564217698150', '0.0000000000000000000000000000000000000000024539', 5, 4);
    checkLnResult('0.999999987593466883036919655717507752311798436584262710410080485802440651098', '-0.00000001240653', 7, 6);
    checkLnResult('1.000000018472078439367595548243230561734', '0.0000000184720782687587567141685374276721136', 36, 0);
    checkLnResult('1.000000000000000000000000000027061294139028140296788935076920940602313183007831066627748504596064337387546517866314036676735728406098988897643792775080246506595767189394976464369', '0.0000000000000000000000000000271', 3, 6);
    checkLnResult('0.999999999999999999999999999999999999999999999999983236514849608313776995668242152423498923869153102324092773269164486380023512206', '-0.0000000000000000000000000000000000000000000000000167634851503916862230043317578', 30, 2);
    checkLnResult('0.999999999999999999998364', '-0.000000000000000000001636', 12, 4);
    checkLnResult('0.999999999984247763351546132381201803224221320759305237486792312341695697664625337191197409538174918606370093200173235377160974530349186640210056578324041384176737202852579773243', '-0.0000000000157522366485779340985139462', 27, 6);
    checkLnResult('0.9999999999999999999990018683160077458539750633020995640413381403082761992348270405950390259594627171842', '-0.0000000000000000000009981317', 7, 4);
    checkLnResult('0.99999999999999999999999999999999999999999999999999985408483944', '-0.00000000000000000000000000000000000000000000000000014591516056', 35, 1);
    checkLnResult('0.999999999999999999999999999999999999999999999999998739619976', '-0.000000000000000000000000000000000000000000000000001260380024', 19, 6);
    checkLnResult('0.99999999999999999999999999999999999999999999999999999885639999798325100337440101041086693875558962971018414706077286569119145472180293030705985903425546926770196944598420458571451206946321039210', '-0.0000000000000000000000000000000000000000000000000000011436000020167489966255989895891330612444103702898', 50, 5);
    checkLnResult('0.9999999999999999999999999999998813849879156043674936830517787361054747787', '-0.0000000000000000000000000000001186', 4, 2);
    checkLnResult('1.0000000000000000000278495935577735173108449580311901557454985107031530689779032404701969152386509968231412912032547047938976884258008764161145204', '0.000000000000000000027849', 5, 1);
    checkLnResult('0.9999999999999999973362461433229285135656310591384423930035289356669163226763087894358613606844049018612982044184276721128495686590536237237362306901212', '-0.0000000000000000026637538566770714899821612453425437643031829', 44, 5);
    checkLnResult('1.00000000000000176253868933517211924999595559448630464030179930682524750778432581467161581396555777249054042674040627129810092955303337', '0.000000000000001762538689335170566', 20, 5);
    checkLnResult('0.99999999999999999999999999999999999977092768577305435532481001390241851854279230037455', '-0.000000000000000000000000000000000000229072314226945644675189986097581481', 36, 1);
    checkLnResult('0.9999999999999999999999999999999999999999999999999999999872655993173067727213258266707420877839338907224927740881477058093177568467325181347117970284259875332114167', '-0.0000000000000000000000000000000000000000000000000000000127344006826932272786742', 24, 3);
    checkLnResult('1.0000000172264280662442594957709154039786849716698889540202736142143930380', '0.00000001722642791786934923900676', 25, 5);
    checkLnResult('0.999999999999999999999999999999999982912873108922', '-0.000000000000000000000000000000000017087126891078', 29, 2);
}
