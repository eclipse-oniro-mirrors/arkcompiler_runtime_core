/**
 * Copyright (c) 2025 Huawei Device Co., Ltd.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

let str1: string = "";
let resultTest: string = "";

function createHaystack(): string {
    let s = "abCdefgz";
    for (let i = 0; i < 3; i++) {
        s += s;
    }
    return s;
}

function String1Replace(re: RegExp): void {
    resultTest = str1.replace(re, ".");
}

function String2Replace(re: RegExp): void {
    resultTest = str1.replace(re, "xyz");
}

function String3Replace(re: RegExp): void {
    resultTest = str1.replace(re, "x$1yz");
}

function Function1Replace(re: RegExp): void {
    resultTest = str1.replace(re, (match: string) => match);
}

function verifyRegExp(text: string): string[] {
    text = text.replace(new RegExp("[\\s]", "g"), ' ');
    let emRegExp = new RegExp("<em>.*?</em>", "ig");
    let results = text.split(emRegExp);
    text.match(emRegExp);
    return results;
}

function GreekAlphabetTestFunction06(): void {
    let quotedEmailUserUtf8 = new RegExp("^([\\s\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f\\x21\\x23-\\x5b\\x5d-\\x7e\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|(\\\\[\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))*$", "i");
    arktest.assertEQ(quotedEmailUserUtf8.test(" foo mç«¯ller "), true)
}

function GreekAlphabetTestFunction07(): void {
    let reg = new RegExp("^[Î‘-Ï]+$", "iu");
    arktest.assertEQ(reg.test('Î¬Î­Î®Î¯Î°ÏŠÏ‹ÏŒÏÏ'), true)
    arktest.assertEQ(reg.test('Î†ÎˆÎ‰ÎŠÎªÎ«ÎÎ'), true)
    arktest.assertEQ(reg.test('Î±Î²Î³Î´ÎµÎ¶Î·Î¸Î¹ÎºÎ»Î¼Î½Î¾Î¿Ï€ÏÏ‚ÏƒÏ„Ï…Ï†Ï‡ÏˆÏ‰'), true)
    arktest.assertEQ(reg.test('Î‘Î’Î“Î”Î•Î–Î—Î˜Î™ÎšÎ›ÎœÎÎÎŸÎ Î¡Î£Î¤Î¥Î¦Î§Î¨Î©'), true)
}

function GreekAlphabetTestFunction08(): void {
    let reg = new RegExp("^[A-ZÃƒÃÃ€Ã‚Ã„Ã‡Ã‰ÃŠÃ‹ÃÃÃ•Ã“Ã”Ã–ÃšÃœ]+$", "iu");
    arktest.assertEQ(reg.test('palÃ­ndromo'), true)
    arktest.assertEQ(reg.test('Ã³rgÃ£o'), true)
    arktest.assertEQ(reg.test('qwÃ©rtyÃºÃ£o'), true)
    arktest.assertEQ(reg.test('Ã Ã¤Ã£cÃ«Ã¼Ã¯Ã„ÃÃœ'), true)
}

function GreekAlphabetTestFunction09(): void {
    let reg = new RegExp("^[A-ZÃ€Ã‰ÃˆÃŒÃÃ“Ã’Ã™]+$", "iu");
    arktest.assertEQ(reg.test('Ã Ã©Ã¨Ã¬Ã®Ã³Ã²Ã¹'), true)
    arktest.assertEQ(reg.test('metrÃ³'), true)
    arktest.assertEQ(reg.test('pÃ¨sca'), true)
    arktest.assertEQ(reg.test('genÃ®'), true)
}

function GreekAlphabetTestFunction10(): void {
    let reg = new RegExp("^[A-ZÃ€Ãáº áº¢ÃƒÃ‚áº¦áº¤áº¬áº¨áºªÄ‚áº°áº®áº¶áº²áº´ÄÃˆÃ‰áº¸áººáº¼ÃŠá»€áº¾á»†á»‚á»„ÃŒÃá»Šá»ˆÄ¨Ã’Ã“á»Œá»Ã•Ã”á»’á»á»˜á»”á»–Æ á»œá»šá»¢á»á» Ã™Ãšá»¤á»¦Å¨Æ¯á»ªá»¨á»°á»¬á»®á»²Ãá»´á»¶á»¸]+$", "iu");
    arktest.assertEQ(reg.test('thiáº¿n'), true)
    arktest.assertEQ(reg.test('nghiÃªng'), true)
    arktest.assertEQ(reg.test('chÃ o'), true)
    arktest.assertEQ(reg.test('tháº¿'), true)
    arktest.assertEQ(reg.test('giá»›i'), true)
}

function GreekAlphabetTestFunction11(): void {
    let reg = new RegExp("^[A-ZÃ…Ã„Ã–]+$", "iu");
    arktest.assertEQ(reg.test('Ã¤iti'), true)
}

function GreekAlphabetTestFunction12(): void {
    let reg = new RegExp("^[A-ZÃ†Ã˜Ã…]+$", "iu");
    arktest.assertEQ(reg.test('aÃ¸Ã¥'), true)
}

function GreekAlphabetTestFunction13(): void {
    let reg = new RegExp("^[A-ZÄ„Ä†Ä˜ÅšÅÅƒÃ“Å»Å¹]+$", "iu");
    arktest.assertEQ(reg.test('kreskÄ…'), true)
    arktest.assertEQ(reg.test('zamkniÄ™te'), true)
    arktest.assertEQ(reg.test('zwykÅ‚e'), true)
    arktest.assertEQ(reg.test('kropkÄ…'), true)
    arktest.assertEQ(reg.test('przyjÄ™Å‚y'), true)
    arktest.assertEQ(reg.test('Å›wiÄ™ty'), true)
    arktest.assertEQ(reg.test('PozwÃ³l'), true)
}

function GreekAlphabetTestFunction14(): void {
    let reg = new RegExp("^[Ğ-Ğ¯Ğ‚ĞˆĞ‰ĞŠĞ‹Ğ]+$", "iu");
    arktest.assertEQ(reg.test('Ğ¨Ñ›Ğ¶Ğ‚Ñ™Ğ•'), true)
}

function GreekAlphabetTestFunction15(): void {
    let reg = new RegExp("^[A-ZÄŒÄ†Å½Å Ä]+$", "iu");
    arktest.assertEQ(reg.test('Å AabÄÅ¡Ä‘Ä‡Å¾'), true)
    arktest.assertEQ(reg.test('Å ATROÄ†ÄÄ‘Å¡'), true)
}

function GreekAlphabetTestFunction16(): void {
    let reg = new RegExp("^[A-ZÃÃ‰ÃÃ‘Ã“ÃšÃœ]+$", "iu");
    arktest.assertEQ(reg.test('Ã¡bcÃ³'), true)
    arktest.assertEQ(reg.test('dormÃ­s'), true)
    arktest.assertEQ(reg.test('volvÃ©s'), true)
    arktest.assertEQ(reg.test('espaÃ±ol'), true)
}

function GreekAlphabetTestFunction17(): void {
    let reg = new RegExp("^[A-ZÃ…Ã„Ã–]+$", "iu");
    arktest.assertEQ(reg.test('religiÃ¶s'), true)
    arktest.assertEQ(reg.test('stjÃ¤la'), true)
    arktest.assertEQ(reg.test('vÃ¤stgÃ¶te'), true)
}

function GreekAlphabetTestFunction18(): void {
    let reg = new RegExp("^[A-ZÃ‡ÄÄ°Ä±Ã–ÅÃœ]+$", "iu");
    arktest.assertEQ(reg.test('AÄ°Ä±Ã–Ã¶Ã‡Ã§ÅÅŸÄÄŸÃœÃ¼Z'), true)
}

function GreekAlphabetTestFunction19(): void {
    let reg = new RegExp("^[Î‘-Ï]+$", "iu");
    arktest.assertEQ(reg.test('Î¬Î­Î®Î¯Î°ÏŠÏ‹ÏŒÏÏ'), true)
    arktest.assertEQ(reg.test('Î†ÎˆÎ‰ÎŠÎªÎ«ÎÎ'), true)
}

function GreekAlphabetTestFunction20(): void {
    let reg = new RegExp("^[0-9A-VXYZÃ‡ÆÄÄ°Ä±Ã–ÅÃœ]+$", "iu");
    arktest.assertEQ(reg.test('AzÉ™rbaycan'), true)
    arktest.assertEQ(reg.test('abcÃ§2'), true)
    arktest.assertEQ(reg.test('3kÉ™rÉ™4kÉ™rÉ™'), true)
}

function GreekAlphabetTestFunction21(): void {
    let reg = new RegExp("^[0-9Ğ-Ğ¯]+$", "iu");
    arktest.assertEQ(reg.test('Ğ°Ğ±Ğ²1'), true)
    arktest.assertEQ(reg.test('Ğ¶Ğ°Ğ±Ğ°'), true)
    arktest.assertEQ(reg.test('ÑĞ“Ğ¾Ğ”Ğ°2'), true)
    arktest.assertEQ(reg.test('Ğ¹Ğ®Ñ'), true)
}

function GreekAlphabetTestFunction22(): void {
    let reg = new RegExp("^[0-9A-ZÃÄŒÄÃ‰ÄšÃÅ‡Ã“Å˜Å Å¤ÃšÅ®ÃÅ½]+$", "iu");
    arktest.assertEQ(reg.test('Å™iÅ¥123'), true)
}

function GreekAlphabetTestFunction23(): void {
    let reg = new RegExp("^[0-9A-ZÃÄŒÄÃ‰ÃÅ‡Ã“Å Å¤ÃšÃÅ½Ä¹Å”Ä½Ã„Ã”]+$", "iu");
    arktest.assertEQ(reg.test('1mÃ´j'), true)
    arktest.assertEQ(reg.test('2Ä¾ÃºbÃ­m'), true)
    arktest.assertEQ(reg.test('3mÃ¤kÄeÅˆ'), true)
    arktest.assertEQ(reg.test('5vÅ•ba'), true)
    arktest.assertEQ(reg.test('6Åˆorimberk'), true)
    arktest.assertEQ(reg.test('7Å¥ava'), true)
    arktest.assertEQ(reg.test('8Å¾anÃ©ta'), true)
    arktest.assertEQ(reg.test('9ÄÃ¡belskÃ©'), true)
    arktest.assertEQ(reg.test('10Ã³dy'), true)
}

function GreekAlphabetTestFunction24(): void {
    let reg = new RegExp("^[0-9A-ZÃÃ‰Ã‹ÃÃ“Ã–ÃœÃš]+$", "iu");
    arktest.assertEQ(reg.test('KÃ¡n123'), true)
    arktest.assertEQ(reg.test('Ã©Ã©n354'), true)
}

function GreekAlphabetTestFunction25(): void {
    let reg = new RegExp("^[0-9A-ZÃ…Ã„Ã–]+$", "iu");
    arktest.assertEQ(reg.test('Ã¤iti124'), true)
    arktest.assertEQ(reg.test('451Ã¥Ã¥23'), true)
}

function GreekAlphabetTestFunction26(): void {
    let reg = new RegExp("^[0-9A-ZÃ„Ã–ÃœÃŸ]+$", "iu");
    arktest.assertEQ(reg.test('Ã¤bc123'), true)
}

function GreekAlphabetTestFunction27(): void {
    let reg = new RegExp("^[0-9A-ZÃÃ‰ÃÃ“Ã–ÅÃšÃœÅ°]+$", "iu");
    arktest.assertEQ(reg.test('0Ã¡rvÃ­ztÅ±rÅ‘tÃ¼kÃ¶rfÃºrÃ³gÃ©p123'), true)

}
function GreekAlphabetTestFunction28(): void {
    let reg = new RegExp("^[0-9A-ZÃƒÃÃ€Ã‚Ã„Ã‡Ã‰ÃŠÃ‹ÃÃÃ•Ã“Ã”Ã–ÃšÃœ]+$", "iu");
    arktest.assertEQ(reg.test('palÃ­ndromo'), true)
    arktest.assertEQ(reg.test('2Ã³rgÃ£o'), true)
    arktest.assertEQ(reg.test('qwÃ©rtyÃºÃ£o9'), true)
    arktest.assertEQ(reg.test('Ã Ã¤Ã£cÃ«4Ã¼Ã¯Ã„ÃÃœ'), true)
}

function GreekAlphabetTestFunction29(): void {
    let reg = new RegExp("^[0-9A-ZÃ€Ã‰ÃˆÃŒÃÃ“Ã’Ã™]+$", "iu");
    arktest.assertEQ(reg.test('123Ã Ã©Ã¨Ã¬Ã®Ã³Ã²Ã¹'), true)
    arktest.assertEQ(reg.test('met23rÃ³'), true)
    arktest.assertEQ(reg.test('pÃ¨s56ca'), true)
    arktest.assertEQ(reg.test('gen45Ã®'), true)
}

function GreekAlphabetTestFunction30(): void {
    let reg = new RegExp("^[0-9A-ZÃÃ‰ÃÃ‘Ã“ÃšÃœ]+$", "iu");
    arktest.assertEQ(reg.test('Ã¡bcÃ³123'), true)
}

function GreekAlphabetTestFunction31(): void {
    let reg = new RegExp("^[0-9A-ZÃ€Ãáº áº¢ÃƒÃ‚áº¦áº¤áº¬áº¨áºªÄ‚áº°áº®áº¶áº²áº´ÄÃˆÃ‰áº¸áººáº¼ÃŠá»€áº¾á»†á»‚á»„ÃŒÃá»Šá»ˆÄ¨Ã’Ã“á»Œá»Ã•Ã”á»’á»á»˜á»”á»–Æ á»œá»šá»¢á»á» Ã™Ãšá»¤á»¦Å¨Æ¯á»ªá»¨á»°á»¬á»®á»²Ãá»´á»¶á»¸]+$", "iu");
    arktest.assertEQ(reg.test('Tháº§y3'), true)
    arktest.assertEQ(reg.test('3GÃ '), true)
}

function GreekAlphabetTestFunction32(): void {
    let reg = new RegExp("^[0-9A-ZÄ„Ä†Ä˜ÅšÅÅƒÃ“Å»Å¹]+$", "iu");
    arktest.assertEQ(reg.test('kre123skÄ…'), true)
    arktest.assertEQ(reg.test('zam21kniÄ™te'), true)
    arktest.assertEQ(reg.test('zw23ykÅ‚e'), true)
    arktest.assertEQ(reg.test('prz23yjÄ™Å‚y'), true)
    arktest.assertEQ(reg.test('Å›wi23Ä™ty'), true)
    arktest.assertEQ(reg.test('Poz1322wÃ³l'), true)
}

function GreekAlphabetTestFunction33(): void {
    let reg = new RegExp("^[0-9Ğ-Ğ¯Ğ‚ĞˆĞ‰ĞŠĞ‹Ğ]+$", "iu");
    arktest.assertEQ(reg.test('Ğ¨Ñ›Ğ¶Ğ‚Ñ™Ğ•123'), true)
}

function GreekAlphabetTestFunction34(): void {
    let reg = new RegExp("^[0-9A-ZÄŒÄ†Å½Å Ä]+$", "iu");
    arktest.assertEQ(reg.test('Å AabÄÅ¡Ä‘Ä‡Å¾123'), true)
    arktest.assertEQ(reg.test('Å ATRO11Ä†ÄÄ‘Å¡'), true)
}

function GreekAlphabetTestFunction35(): void {
    let reg = new RegExp("^[0-9A-ZÃ…Ã„Ã–]+$", "iu");
    arktest.assertEQ(reg.test('religiÃ¶s13'), true)
    arktest.assertEQ(reg.test('st23jÃ¤la'), true)
    arktest.assertEQ(reg.test('vÃ¤stgÃ¶te123'), true)
}

function GreekAlphabetTestFunction36(): void {
    let reg = new RegExp("^[0-9A-ZÃ‡ÄÄ°Ä±Ã–ÅÃœ]+$", "iu");
    arktest.assertEQ(reg.test('AÄ°Ä±Ã–Ã¶Ã‡Ã§ÅÅŸÄÄŸÃœÃ¼Z123'), true)
}

function GreekAlphabetTestFunction37(): void {
    let reg = new RegExp("^[-+]?([0-9]+)?(\\Ù«[0-9]{1,})?$", "u");
    arktest.assertEQ(reg.test('0Ù«0000000000001'), true)
}

function GreekAlphabetTestFunction38(): void {
    let reg = new RegExp("^(?:[-+])?(?:[0-9]+)?(?:\\Ù«[0-9]*)?(?:[eE][\\+\\-]?(?:[0-9]+))?$", "u");
    arktest.assertEQ(reg.test('123Ù«'), true)
    arktest.assertEQ(reg.test('123Ù«123'), true)
    arktest.assertEQ(reg.test('-123Ù«123'), true)
}

function GreekAlphabetTestFunction39(): void {
    let reg = new RegExp("^[A-Z0-9_\\-]*$", "iu");
    arktest.assertEQ(reg.test(''), true)
}

function GreekAlphabetTestFunction40(): void {
    let reg = new RegExp("^(?!-? )(?=.*\\d)(\\Â¥)?-?(0|[1-9]\\d|[1-9]\\d{0,2}(\\,\\d{3})*)?(\\.(\\d{2}))?$", "iu");
    arktest.assertEQ(reg.test('Â¥6,954,231'), true)
    arktest.assertEQ(reg.test('Â¥-6,954,231'), true)
}

function GreekAlphabetTestFunction41(): void {
    let reg = new RegExp("^[A-VXYZÃ‡ÆÄÄ°Ä±Ã–ÅÃœ]+$", "iu");
    arktest.assertEQ(reg.test('AzÉ™rbaycan'), true)
    arktest.assertEQ(reg.test('Ã¼Ã¶ÄŸÄ±É™Ã§ÅŸ'), true)
    arktest.assertEQ(reg.test('sizAzÉ™rbaycanlaÅŸdÄ±rÄ±lmÄ±ÅŸlardansÄ±nÄ±zmÄ±'), true)
    arktest.assertEQ(reg.test('dahaBirDÃ¼zgÃ¼nString'), true)
    arktest.assertEQ(reg.test('abcÃ§deÉ™fgÄŸhxÄ±ijkqlmnoÃ¶prsÅŸtuÃ¼vyz'), true)
}

function GreekAlphabetTestFunction42(): void {
    let reg = new RegExp("^[Ğ-Ğ¯]+$", "iu");
    arktest.assertEQ(reg.test('Ğ°Ğ±Ğ²'), true)
    arktest.assertEQ(reg.test('Ğ¶Ğ°Ğ±Ğ°'), true)
    arktest.assertEQ(reg.test('ÑĞ“Ğ¾Ğ”Ğ°'), true)
}

function GreekAlphabetTestFunction43(): void {
    let reg = new RegExp("^[A-ZÃÄŒÄÃ‰ÄšÃÅ‡Ã“Å˜Å Å¤ÃšÅ®ÃÅ½]+$", "iu");
    arktest.assertEQ(reg.test('Å¾luÅ¥ouÄkÃ½'), true)
    arktest.assertEQ(reg.test('PÄ›l'), true)
    arktest.assertEQ(reg.test('ÄÃ¡belskÃ©'), true)
    arktest.assertEQ(reg.test('Ã³dy'), true)
}

function GreekAlphabetTestFunction44(): void {
    let reg = new RegExp("^[A-ZÃÄŒÄÃ‰ÃÅ‡Ã“Å Å¤ÃšÃÅ½Ä¹Å”Ä½Ã„Ã”]+$", "iu");
    arktest.assertEQ(reg.test('mÃ´j'), true)
    arktest.assertEQ(reg.test('Ä¾ÃºbÃ­m'), true)
    arktest.assertEQ(reg.test('mÃ¤kÄeÅˆ'), true)
    arktest.assertEQ(reg.test('vÅ•ba'), true)
    arktest.assertEQ(reg.test('Åˆorimberk'), true)
}

function GreekAlphabetTestFunction45(): void {
    let reg = new RegExp("^[A-ZÃ†Ã˜Ã…]+$", "iu");
    arktest.assertEQ(reg.test('aÃ¸Ã¥'), true)
}

function GreekAlphabetTestFunction46(): void {
    let reg = new RegExp("^[A-ZÃÃ‰Ã‹ÃÃ“Ã–ÃœÃš]+$", "iu");
    arktest.assertEQ(reg.test('KÃ¡n'), true)
    arktest.assertEQ(reg.test('Ã©Ã©n'), true)
    arktest.assertEQ(reg.test('vÃ³Ã³r'), true)
    arktest.assertEQ(reg.test('nÃº'), true)
    arktest.assertEQ(reg.test('hÃ©Ã©l'), true)
}

function GreekAlphabetTestFunction47(): void {
    let reg = new RegExp("^[A-ZÃ„Ã–ÃœÃŸ]+$", "iu");
    arktest.assertEQ(reg.test('Ã¤bc'), true)
    arktest.assertEQ(reg.test('FÃ¶Ã–bÃ¤r'), true)
}

function GreekAlphabetTestFunction48(): void {
    let reg = new RegExp("^[A-ZÃÃ‰ÃÃ“Ã–ÅÃšÃœÅ°]+$", "iu");
    arktest.assertEQ(reg.test('Ã¡rvÃ­ztÅ±rÅ‘tÃ¼kÃ¶rfÃºrÃ³gÃ©p'), true)
}

function GreekAlphabetTest(): void {
    GreekAlphabetTestFunction06();
    GreekAlphabetTestFunction07();
    GreekAlphabetTestFunction08();
    GreekAlphabetTestFunction09();
    GreekAlphabetTestFunction10();
    GreekAlphabetTestFunction11();
    GreekAlphabetTestFunction12();
    GreekAlphabetTestFunction13();
    GreekAlphabetTestFunction14();
    GreekAlphabetTestFunction15();
    GreekAlphabetTestFunction16();
    GreekAlphabetTestFunction17();
    GreekAlphabetTestFunction18();
    GreekAlphabetTestFunction19();
    GreekAlphabetTestFunction20();
    GreekAlphabetTestFunction21();
    GreekAlphabetTestFunction22();
    GreekAlphabetTestFunction23();
    GreekAlphabetTestFunction24();
    GreekAlphabetTestFunction25();
    GreekAlphabetTestFunction26();
    GreekAlphabetTestFunction27();
    GreekAlphabetTestFunction28();
    GreekAlphabetTestFunction29();
    GreekAlphabetTestFunction30();
    GreekAlphabetTestFunction31();
    GreekAlphabetTestFunction32();
    GreekAlphabetTestFunction33();
    GreekAlphabetTestFunction34();
    GreekAlphabetTestFunction35();
    GreekAlphabetTestFunction36();
    GreekAlphabetTestFunction37();
    GreekAlphabetTestFunction38();
    GreekAlphabetTestFunction39();
    GreekAlphabetTestFunction40();
    GreekAlphabetTestFunction41();
    GreekAlphabetTestFunction42();
    GreekAlphabetTestFunction43();
    GreekAlphabetTestFunction44();
    GreekAlphabetTestFunction45();
    GreekAlphabetTestFunction46();
    GreekAlphabetTestFunction47();
    GreekAlphabetTestFunction48();
}

function main(): void {
    {
        let reg = new RegExp("ab|cd||")
        arktest.assertEQ(JSON.stringify(reg.exec("cd")), '["cd"]')
    }
    {
        let reg = new RegExp("ab||")
        arktest.assertEQ(JSON.stringify(reg.exec("cd")), '[""]')
    }
    {
        let reg = new RegExp("ab|cd|ef")
        arktest.assertEQ(JSON.stringify(reg.exec("cd")), '["cd"]')
    }
    {
        let str = "ğŸ˜€";
        let regexp = new RegExp("[ğŸ˜€]");
        arktest.assertEQ(JSON.stringify(str.replace(regexp, "b")), JSON.stringify("b\ude00"));
    }
    {
        let str = "ğŸ˜€";
        let regexp = new RegExp("[ğŸ˜€]", "g");
        arktest.assertEQ(JSON.stringify(str.replace(regexp, "b")), JSON.stringify("bb"));
    }
    {
        let str = "ğŸ˜€";
        let regexp = new RegExp("[ğŸ˜€]", "u");
        arktest.assertEQ(JSON.stringify(str.replace(regexp, "b")), JSON.stringify("b"));
    }
    {
        let str = "ğŸ˜€";
        let regexp = new RegExp("[ğŸ˜€]", "s");
        arktest.assertEQ(JSON.stringify(str.replace(regexp, "b")), JSON.stringify("b\ude00"));
    }

    const re1 = new RegExp("[Cz]");
    const re2 = new RegExp("[Cz]", "g");
    const re3 = new RegExp("([Cz])");
    const re4 = new RegExp("([Cz])", "g");

    str1 = createHaystack();

    String1Replace(re1);
    arktest.assertEQ(resultTest, "ab.defgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgz");

    String1Replace(re2);
    arktest.assertEQ(resultTest, "ab.defg.ab.defg.ab.defg.ab.defg.ab.defg.ab.defg.ab.defg.ab.defg.");

    String2Replace(re2);
    arktest.assertEQ(resultTest, "abxyzdefgxyzabxyzdefgxyzabxyzdefgxyzabxyzdefgxyzabxyzdefgxyzabxyzdefgxyzabxyzdefgxyzabxyzdefgxyz");

    String2Replace(re1);
    arktest.assertEQ(resultTest, "abxyzdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgz");

    String3Replace(re3);
    arktest.assertEQ(resultTest, "abxCyzdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgz");

    String3Replace(re4);
    arktest.assertEQ(resultTest, "abxCyzdefgxzyzabxCyzdefgxzyzabxCyzdefgxzyzabxCyzdefgxzyzabxCyzdefgxzyzabxCyzdefgxzyzabxCyzdefgxzyzabxCyzdefgxzyz");

    Function1Replace(re3);
    arktest.assertEQ(resultTest, "abCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgz");

    Function1Replace(re4);
    arktest.assertEQ(resultTest, "abCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgzabCdefgz");

    let reg0 = new RegExp("[\\x5d-\\x7e]", "i");
    let result = reg0.test("a");
    arktest.assertEQ(result, true);

    let reg1 = new RegExp("^[-+]?([0-9]+)?(\\Ù«[0-9]{1,})?$");
    let result1 = reg1.test('0Ù«0000000000001');
    arktest.assertEQ(result1, true);

    let reg2 = new RegExp("^[A-Z0-9_\\-]*$", "i");
    arktest.assertEQ(reg2.test(''), true)

    let reg3 = new RegExp("^(?<urlStrIndex>.*?)(?<urlStr>https?[:ï¼š]//[^/]+/svn(?:/[a-z0-9.,;?'*:+&%$#=~_ \\u4E00-\\u9FA5-]*)*).*$", "i")
    arktest.assertEQ(reg3.test('a'), false);

    let reg4 = new RegExp("^(?<urlStrIndex>.*?)(?<urlStr>(?:(?:ht|f)tps?[:ï¼š]//)?(?:[a-z0-9-]+\\.)+" + "(?:com|edu|gov|mil|net|org|biz|info|name|museum|us|ca|uk|cn|cc|tw|de|au|sg|hk|ei|fr|me|im)(?![a-z])" + "(?:\\:[0-9][0-9]*)?(?:\\.?/[a-z0-9.,;?'\\|*:\\\\+&%$#=~_-]*)*).*$", "i")
    arktest.assertEQ(reg4.test('a'), false);

    let reg5 = new RegExp("^(?<urlStrIndex>.*?)(?<urlStr>(?:ht|f)tps?[:ï¼š]//(?:[a-z0-9-]+\\.)*[a-z0-9-]+(?:/[a-z0-9]+)*[/a-z0-9.,;?'\\|*:\\\\+&%$#=~_-]*).*$", "i")
    arktest.assertEQ(reg5.test('a'), false);

    let reg6 = new RegExp("^(?<urlStrIndex>.*?)(?<urlStr>(?:https?[:ï¼š]//)?(?:[a-z0-9-\\\\]+\\.)+" + "(?:com|edu|gov|mil|net|org|biz|info|name|museum|us|ca|uk|cn|cc|tw|de|au|sg|hk|ei|fr|me|im)(?![a-z])" + "(?:\\:\\d{4})?(?:/[a-z0-9.,;?'\\|*:\\\\+&%$#=~_-]*)*\\?(?:[a-z0-9]*=[a-z0-9.,;?'*:+%$#=~_\\u4E00-\\u9FA5-]*&?)*).*$", "i")
    arktest.assertEQ(reg6.test('a'), false);

    GreekAlphabetTest();

    {
        let arr1: boolean[] = [];
        let temp1 = false;
        let reg49 = new RegExp("[^A-Z0-9+/=]", "i");
        arr1.push(reg49.test("Zg=="));
        arr1.push(reg49.test("Zm8="));
        arr1.push(reg49.test("Zm9v"));
        arr1.push(reg49.test("Zm9vYg=="));
        arr1.push(reg49.test("Zm9vYmE="));
        arr1.push(reg49.test("Zm9vYmFy"));
        arr1.push(reg49.test(
            "TG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2NpbmcgZWxpdC4="
        ));
        arr1.push(reg49.test("Vml2YW11cyBmZXJtZW50dW0gc2VtcGVyIHBvcnRhLg=="));
        arr1.push(reg49.test("U3VzcGVuZGlzc2UgbGVjdHVzIGxlbw=="));
        arr1.forEach((item) => {
            if (item) {
                temp1 = true;
            }
        });
        arktest.assertEQ(temp1, false);
    }

    {
        let str1 = 'SC52BAHL01031234567890123456USD';
        arktest.assertEQ(str1.replace(new RegExp("[^A-Z0-9]+", "gi"), ''), "SC52BAHL01031234567890123456USD");

        let regabc = new RegExp("abc", "g");
        let strabcd = "abcdabcdabcd";
        let exceptArr: boolean[] = [true, true, true, false, true, true, true, false, true, true];
        let resultArr: boolean[] = [];
        for (let i = 0; i < 10; i++) {
            // cache is used in this case
            resultArr.push(regabc.test(strabcd));
        }
        arktest.assertEQ(JSON.stringify(exceptArr), JSON.stringify(resultArr));

        let str2 = "aaaabbBbcccC";
        for (let i = 0; i < 2; i++) {
            arktest.assertEQ(str2, 'aaaabbBbcccC');
            let t1 = str2.replace(new RegExp("([A-Z])", "g"), (e: string) => {
                return "_" + e;
            });
            arktest.assertEQ(t1, 'aaaabb_Bbccc_C');
            let t2 = str2.replace(new RegExp("([A-Z])", "g"), "_$1");
            arktest.assertEQ(t2, 'aaaabb_Bbccc_C');
            arktest.assertEQ(t1.replace(new RegExp("([a-z]+)", "g"), "_xy"), '_xy_B_xy_C');
            arktest.assertEQ(t2.replace(new RegExp("_", "g"), ""), 'aaaabbBbcccC');
        }
    }

    {
        let regexp1 = new RegExp("a*", "gs");
        let regexp2 = new RegExp("a*", "g");
        regexp2.lastIndex = 8;
        arktest.assertEQ(regexp1.exec('aaa')?.toString(), 'aaa');
        arktest.assertEQ(regexp2.exec('aaa'), null);

        let regexp3 = new RegExp("a*", "g");
        let regexp4 = new RegExp("a*", "g");
        regexp4.lastIndex = 1;
        arktest.assertEQ(regexp3.exec('aaabab')?.toString(), 'aaa');
        arktest.assertEQ(regexp4.exec('aaabaa')?.toString(), 'aa');
    }

    // Testing regexp.prototype.replace after optimization
    {
        const re1 = new RegExp("[Cz]");
        const re2 = new RegExp("[Cz]", "g");
        const re3 = new RegExp("([Cz])");
        const re4 = new RegExp("([Cz])", "g");

        let replace_str = "abCdefgzabCdefgzabCdefgz";
        let replace_result = replace_str.replace(re1, "");
        arktest.assertEQ(re1.lastIndex, 0);
        let cached_reuslt = replace_str.replace(re1, "");
        arktest.assertEQ(replace_result === cached_reuslt, true);
        arktest.assertEQ(re1.lastIndex, 0);

        replace_result = replace_str.replace(re2, "xyz");
        arktest.assertEQ(re2.lastIndex, 0);
        cached_reuslt = replace_str.replace(re2, "xyz");
        arktest.assertEQ(replace_result === cached_reuslt, true);
        arktest.assertEQ(re2.lastIndex, 0);

        replace_result = replace_str.replace(re3, "x$1yz");
        arktest.assertEQ(re3.lastIndex, 0);
        cached_reuslt = replace_str.replace(re3, "x$1yz");
        arktest.assertEQ(replace_result === cached_reuslt, true);
        arktest.assertEQ(re3.lastIndex, 0);

        replace_result = replace_str.replace(re4, (match: string) => match);
        arktest.assertEQ(re4.lastIndex, 0);
        cached_reuslt = replace_str.replace(re4, (match: string) => match);
        arktest.assertEQ(replace_result === cached_reuslt, true);
        arktest.assertEQ(re4.lastIndex, 0);
    }

    {
        let inputString = "/vedio/av{avid}{cid}";
        let extractedContent = inputString.match(new RegExp("\\{([^{}]+)\\}", "g"));
        let replacedString = inputString.replace(new RegExp("\\{([^{}]+)\\}", "g"), '(uuu)').replace(new RegExp("\\/", "g"), "\\/");
        arktest.assertEQ(replacedString, '\\/vedio\\/av(uuu)(uuu)');

        let str = "beep boop   afffæµ‹è¯•æ ·æœ¬one1";
        arktest.assertEQ(str.split(new RegExp("([{}:;,]|\\s+)")).toString(), 'beep, ,boop,   ,afffæµ‹è¯•æ ·æœ¬one1');

        const srcTextA = '<em>a</em>bcdefghijklmnopqrstuvwxyz<em>a</em>bcdefghijklmnopqrstuvwxyz<em>a</em>bcdefghijklmnopqrstuvwxyz<em>a</em>bcdefghijklmnopqrstuvwxyz';
        const srcTextAbcd = '<em>abcd</em>efghijklmnopqrstuvwxyz<em>abcd</em>efghijklmnopqrstuvwxyz<em>abcd</em>efghijklmnopqrstuvwxyz<em>abcd</em>efghijklmnopqrstuvwxyz';

        let s0 = `verifyRegExp_1: ${verifyRegExp(srcTextA)}`;
        arktest.assertEQ(s0, 'verifyRegExp_1: ,bcdefghijklmnopqrstuvwxyz,bcdefghijklmnopqrstuvwxyz,bcdefghijklmnopqrstuvwxyz,bcdefghijklmnopqrstuvwxyz');
        let s1 = `verifyRegExp_2: ${verifyRegExp(srcTextAbcd)}`;
        arktest.assertEQ(s1, 'verifyRegExp_2: ,efghijklmnopqrstuvwxyz,efghijklmnopqrstuvwxyz,efghijklmnopqrstuvwxyz,efghijklmnopqrstuvwxyz');
        let s2 = `verifyRegExp_3: ${verifyRegExp(srcTextAbcd)}`;
        arktest.assertEQ(s2, 'verifyRegExp_3: ,efghijklmnopqrstuvwxyz,efghijklmnopqrstuvwxyz,efghijklmnopqrstuvwxyz,efghijklmnopqrstuvwxyz');
    }

    {
        try {
            const ans11 = new RegExp("/[\\p{}]/u");
            throw Error()
        } catch (error) {
            arktest.assertEQ(error instanceof SyntaxError, true);
        }
        const str3 = "a-b-c";
        const re = new RegExp("-", "y");
        arktest.assertEQ(str3.split(re).toString(), 'a,b,c');

        re.lastIndex = 1;
        arktest.assertEQ(str3.split(re).toString(), 'a,b,c');

        re.lastIndex = -1;
        arktest.assertEQ(str3.split(re).toString(), 'a,b,c');

        re.lastIndex = 3;
        arktest.assertEQ(str3.split(re).toString(), 'a,b,c');

        arktest.assertEQ(re.test(str3), true);

        arktest.assertEQ(str3.split(new RegExp("-", "g")).toString(), 'a,b,c');
    }

    {
        // search
        const str4 = "abc";
        let re1 = new RegExp("b");
        re1.lastIndex = 2;
        arktest.assertEQ(str4.search(re1), 1);
        arktest.assertEQ(str4.search(new RegExp("b", "y")), -1);
        arktest.assertEQ(str4.search(re1), 1);
        arktest.assertEQ(re1.lastIndex, 2);

        // check cache
        const str5 = "a-bc";
        let re2 = new RegExp("-");
        re2.lastIndex = 2;
        arktest.assertEQ(str5.split(re2).toString(), 'a,bc');
        arktest.assertEQ(re2.lastIndex, 2);
        arktest.assertEQ(str5.split(re2).toString(), 'a,bc');
        arktest.assertEQ(re2.lastIndex, 2);

        const str6 = "abcabc";
        let re3 = new RegExp("abc");
        re3.lastIndex = 2;
        arktest.assertEQ(str6.match(re3)!.toString(), 'abc');
        arktest.assertEQ(re3.lastIndex, 2);
        arktest.assertEQ(str6.match(re3)!.toString(), 'abc');
        arktest.assertEQ(re3.lastIndex, 2);

        let re4 = new RegExp("abc", "g");
        re4.lastIndex = 2;
        arktest.assertEQ(str6.match(re4)!.toString(), 'abc,abc');
        arktest.assertEQ(re4.lastIndex, 0);
        arktest.assertEQ(str6.match(re4)!.toString(), 'abc,abc');
        arktest.assertEQ(re4.lastIndex, 0);
    }

    {
        const regex = new RegExp("(?:)+");
        const str10 = "abcabcabc";
        const matches = regex.test(str10);
        arktest.assertEQ(matches, true);
        const matches1 = regex.exec(str10);
        arktest.assertEQ(matches1!.toString(), "");
    }

    {
        let str = new RegExp("^\s*([^;\s]*)");
        str.test("text/html");
        arktest.assertEQ(RegExp.$1, 'text/html');
        str.test("text/plain");
        arktest.assertEQ(RegExp.$1, 'text/plain');
        str.test("text/html");
        arktest.assertEQ(RegExp.$1, 'text/html');
    }

    // test getFlags
    {
        const res = new RegExp("abc", "giymsud");
        res.lastIndex = -1;
        arktest.assertEQ(res.flags, 'dgimsuy');
        const res1 = new RegExp("abc", "g");
        res1.lastIndex = -1;
        arktest.assertEQ(res1.flags, 'g');
        const res2 = new RegExp("abc", "i");;
        res2.lastIndex = -1;
        arktest.assertEQ(res2.flags, 'i');
        const res3 = new RegExp("abc", "y");;
        res3.lastIndex = -1;
        arktest.assertEQ(res3.flags, 'y');
        const res4 = new RegExp("abc", "m");;
        res4.lastIndex = -1;
        arktest.assertEQ(res4.flags, 'm');
        const res5 = new RegExp("abc", "s");;
        res5.lastIndex = -1;
        arktest.assertEQ(res5.flags, 's');
        const res6 = new RegExp("abc", "u");;
        res6.lastIndex = -1;
        arktest.assertEQ(res6.flags, 'u');
        const res7 = new RegExp("abc", "d");;
        res7.lastIndex = -1;
        arktest.assertEQ(res7.flags, 'd');
        const res8 = new RegExp("abc");;
        res8.lastIndex = -1;
        arktest.assertEQ(res8.flags, '');
    }

    {
        let str = "\\\\\\\\[aaa"
        try {
            let pattern = "[";
            let reg = new RegExp(pattern);
            throw Error()
        } catch (error) {
            arktest.assertEQ(error instanceof SyntaxError, true);
        }
        try {
            let pattern = "\[";
            let reg = new RegExp(pattern);
            throw Error()
        } catch (error) {
            arktest.assertEQ(error instanceof SyntaxError, true);
        }
        try {
            let pattern = "\\[";
            let reg = new RegExp(pattern);
            arktest.assertEQ(pattern + " " + JSON.stringify(reg.exec(str)), '\\[ ["["]')
        } catch (error) {
            arktest.assertEQ(true, false, "Expected SyntaxError but got none");
        }
        try {
            let pattern = "\\\[";
            let reg = new RegExp(pattern);
            arktest.assertEQ(pattern + " " + JSON.stringify(reg.exec(str)), '\\[ ["["]')
        } catch (error) {
            arktest.assertEQ(true, false, "Expected SyntaxError but got none");
        }
        try {
            let pattern = "\\\\[";
            let reg = new RegExp(pattern);
            throw Error()
        } catch (error) {
            arktest.assertEQ(error instanceof SyntaxError, true);
        }
        try {
            let pattern = "\\\\\[";
            let reg = new RegExp(pattern);
            throw Error()
        } catch (error) {
            arktest.assertEQ(error instanceof SyntaxError, true);
        }
        try {
            let pattern = "\\\\\\[";
            let reg = new RegExp(pattern);
            arktest.assertEQ(pattern + " " + JSON.stringify(reg.exec(str)), '\\\\\\[ ["\\\\["]')
        } catch (error) {
            arktest.assertEQ(true, false, "Expected SyntaxError but got none");
        }
        try {
            let pattern = "\\\\\\\[";
            let reg = new RegExp(pattern);
            arktest.assertEQ(pattern + " " + JSON.stringify(reg.exec(str)), '\\\\\\[ ["\\\\["]')
        } catch (error) {
            arktest.assertEQ(true, false, "Expected SyntaxError but got none");
        }
    }

    {
        // subStringIsUtf8 branch canbecompressed
        str1 = 'utf83cè¿™è¦æ›¿æ¢"!';
        let regexp = new RegExp("([0-9])([a-z])", "g");
        let newStr1 = str1.replace(regexp, "$1");
        arktest.assertEQ(newStr1, 'utf83è¿™è¦æ›¿æ¢"!');

        // subStringIsUtf8 branch length=0;
        str1 = '3cè¿™è¦æ›¿æ¢"!';
        regexp = new RegExp("([0-9])([a-z])", "g");
        newStr1 = str1.replace(regexp, "$1");
        arktest.assertEQ(newStr1, '3è¿™è¦æ›¿æ¢"!');

        // subStringIsUtf8 branch src isUtf8;
        str1 = 'abcdefg3chigk"!';
        regexp = new RegExp("([0-9])([a-z])", "g");
        newStr1 = str1.replace(regexp, "$1");
        arktest.assertEQ(newStr1, 'abcdefg3higk"!');
    }

    {
        let s1 = 'abc';
        let s2 = '\ud834\udf06';
        let reg = new RegExp(s1.repeat(10000));
        let str = s1.repeat(10000);
        let res = str.replace(reg, s2);
        arktest.assertEQ(res == s2, true);

        reg = new RegExp(s2.repeat(10000));
        str = s2.repeat(10000);
        res = str.replace(reg, s1);
        arktest.assertEQ(res == s1, true);
    }

    {
        let reg = new RegExp("a(?:|x)$");
        arktest.assertEQ(JSON.stringify(reg.exec("ax")), '["ax"]')
    }
}
