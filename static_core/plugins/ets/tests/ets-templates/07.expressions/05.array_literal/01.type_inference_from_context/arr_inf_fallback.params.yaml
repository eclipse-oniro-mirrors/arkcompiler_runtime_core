# Copyright (c) 2026 Huawei Device Co., Ltd.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
cases:
    # context type is Object
    - use: |-
          // Spec example from 7.5.1: let o: Object = [1, 2]
          // Type inferred from elements (int[]), assignable to Object
          let o: Object = [1, 2]
          arktest.assertTrue(o instanceof Object)
          arktest.assertTrue(o instanceof Array)
          let arr = o as int[]
          arktest.assertEQ(arr[0], 1)
          arktest.assertEQ(arr[1], 2)
          arktest.assertEQ(arr.length, 2)

    # Context type is Object, elements are strings
    - use: |-
          // Context: Object, elements: strings
          let o: Object = ["hello", "world"]
          arktest.assertTrue(o instanceof Object)
          arktest.assertTrue(o instanceof Array)
          let arr = o as string[]
          arktest.assertEQ(arr[0], "hello")
          arktest.assertEQ(arr[1], "world")
          arktest.assertEQ(arr.length, 2)

    # Context type is Object, elements are mixed (union type inferred)
    - use: |-
          // Context: Object, elements: mixed types
          let o: Object = [1, "hello", true]
          arktest.assertTrue(o instanceof Object)
          arktest.assertTrue(o instanceof Array)
          let arr = o as (int|string|boolean)[]
          arktest.assertEQ(arr[0] as int, 1)
          arktest.assertEQ(arr[1] as string, "hello")
          arktest.assertEQ(arr[2] as boolean, true)
          arktest.assertEQ(arr.length, 3)

    # Context type is Object, elements are objects
    - decl: |-
          class A {
              value: int = 11
          }
      use: |-
          // Context: Object, elements: class instances
          let o: Object = [new A(), new A()]
          arktest.assertTrue(o instanceof Object)
          arktest.assertTrue(o instanceof Array)
          let arr = o as A[]
          arktest.assertEQ(arr[0].value, 11)
          arktest.assertEQ(arr[1].value, 11)
          arktest.assertEQ(arr.length, 2)

    # Context type is Object, nested arrays
    - use: |-
          // Context: Object, elements: nested arrays
          let o: Object = [[1, 2], [3, 4]]
          arktest.assertTrue(o instanceof Object)
          arktest.assertTrue(o instanceof Array)
          let arr = o as int[][]
          arktest.assertEQ(arr[0][0], 1)
          arktest.assertEQ(arr[0][1], 2)
          arktest.assertEQ(arr[1][0], 3)
          arktest.assertEQ(arr[1][1], 4)
          arktest.assertEQ(arr.length, 2)

    # Context type is Object, bigint elements
    - use: |-
          // Context: Object, elements: bigint
          let o: Object = [1n, 2n, 3n]
          arktest.assertTrue(o instanceof Object)
          arktest.assertTrue(o instanceof Array)
          let arr = o as bigint[]
          arktest.assertEQ(arr[0], 1n)
          arktest.assertEQ(arr[1], 2n)
          arktest.assertEQ(arr[2], 3n)
          arktest.assertEQ(arr.length, 3)

    # Context type is Object, boolean elements
    - use: |-
          // Context: Object, elements: boolean
          let o: Object = [true, false, true]
          arktest.assertTrue(o instanceof Object)
          arktest.assertTrue(o instanceof Array)
          let arr = o as boolean[]
          arktest.assertEQ(arr[0], true)
          arktest.assertEQ(arr[1], false)
          arktest.assertEQ(arr[2], true)
          arktest.assertEQ(arr.length, 3)

    # Context type is Object, Number boxed type elements
    - use: |-
          // Context: Object, elements: Number (boxed)
          let o: Object = [new Number(1), new Number(2)]
          arktest.assertTrue(o instanceof Object)
          arktest.assertTrue(o instanceof Array)
          let arr = o as Number[]
          arktest.assertEQ(arr[0].valueOf(), 1)
          arktest.assertEQ(arr[1].valueOf(), 2)
          arktest.assertEQ(arr.length, 2)
