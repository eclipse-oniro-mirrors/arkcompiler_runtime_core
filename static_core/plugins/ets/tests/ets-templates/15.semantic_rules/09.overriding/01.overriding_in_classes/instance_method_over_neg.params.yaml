# Copyright (c) 2025 Huawei Device Co., Ltd.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
cases:

# Class
  # CTE due to args covariance
  - base: "i: A"
    derived: "i: B"

    call: "new A()"
    res: 0
    expected_error: |-
      /* @@@ label2 Error TypeError: No matching call signature */
  - base: "i: A"
    derived: "i: B"
    call: "new B()"

    res: 0
    expected_error: |-
      /* @@@ label2 Error TypeError: No matching call signature */

# Function
  # paramval is the same, retval is contravariant -> expected CTE
  - base: "i: FUN_AB"
    derived: "i: FUN_AA"
    call: "faa"
    res: 0

    expected_error: |-
      /* @@@ label1 Error TypeError: Cannot override */

  # paramval is covariant, retval is the same -> CTE
  - base: "i: FUN_AB"
    derived: "i: FUN_BB"
    call: "fbb"
    res: 0

    expected_error: |-
      /* @@@ label1 Error TypeError: Cannot override */
  # paramval is covariant, retval is covariant -> CTE
  - base: "i: FUN_AB"
    derived: "i: FUN_BC"
    call: "fbc"
    res: 0

    expected_error: |-
      /* @@@ label1 Error TypeError: Cannot override */
  # paramval is covariant, retval is contravariant -> CTE
  - base: "i: FUN_AB"
    derived: "i: FUN_BA"
    call: "fbc"
    res: 0

    expected_error: |-
      /* @@@ label1 Error TypeError: Cannot override */

  # paramval is contravariant, retval is contravariant -> CTE
  - base: "i: FUN_BB"
    derived: "i: FUN_AA"
    call: "faa"
    res: 0

    expected_error: |-
      /* @@@ label1 Error TypeError: Cannot override */

# Array
  # not-related types -> CTE
  - base: "i: FixedArray<int>"
    derived: "i: FixedArray<float>"
    call: "new int[2]"
    res: 0

    expected_error: |-
      /* @@@ label1 Error TypeError: Cannot override */
  - base: "i: int[]"
    derived: "i: float[]"
    call: "new float[1]"
    res: 0

    expected_error: |-
      /* @@@ label1 Error TypeError: Cannot override */
  - base: "i: int[]"
    derived: "i: double[]"
    call: "new double[2]"
    res: 0

    expected_error: |-
      /* @@@ label1 Error TypeError: Cannot override */
  - base: "i: FixedArray<String>"
    derived: "i: FixedArray<Number>"
    call: "new String[1]"
    res: 0

    expected_error: |-
      /* @@@ label1 Error TypeError: Cannot override */
  # using of covariant relationship -> CTE
  - base: "i: FixedArray<A>"
    derived: "i: FixedArray<B>"
    call: "[new A()]"
    res: 0

    expected_error: |-
      /* @@@ label1 Error TypeError: Cannot override */

