# Copyright (c) 2025 Huawei Device Co., Ltd.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
cases:
    - decl: |-
          // primitives and boxed
          class A {
              t: string = ""
              getType(): string {
                  return this.t
              }
              constructor(p: byte) { this.t = "byte" }
              constructor(p: short) { this.t = "short" }
              constructor(p: int) { this.t = "int" }
              constructor(p: long) { this.t = "long" }
              constructor(p: char) { this.t = "char" }
              constructor(p: boolean) { this.t = "boolean" }
              constructor(p: float) { this.t = "float" }
              constructor(p: double) { this.t = "double" }
          }
      use: |-
          arktest.assertEQ(new A(new Byte(-1 as byte)).getType(), "byte")
          arktest.assertEQ(new A(new Short(-1 as short)).getType(), "short")
          arktest.assertEQ(new A(new Int(-1 as int)).getType(), "int")
          arktest.assertEQ(new A(new Long(-1 as long)).getType(), "long")
          arktest.assertEQ(new A(new Char(c'A')).getType(), "char")
          arktest.assertEQ(new A(new Boolean(false)).getType(), "boolean")
          arktest.assertEQ(new A(new Float(3.14.toFloat())).getType(), "float")
          arktest.assertEQ(new A(new Double(3.14)).getType(), "double")
          arktest.assertEQ(new A(-1 as long).getType(), "long")
          arktest.assertEQ(new A(-1).getType(), "byte")
          arktest.assertEQ(new A(-1 as short).getType(), "short")
          arktest.assertEQ(new A(-1 as byte).getType(), "byte")
          arktest.assertEQ(new A(c'A').getType(), "char")
          arktest.assertEQ(new A(false).getType(), "boolean")
          arktest.assertEQ(new A(3.14).getType(), "double")
          arktest.assertEQ(new A(3.14.toFloat()).getType(), "float")

    - decl: |-
          // enums
          enum Color { Red, Green=82, Blue }
          enum Size { S="small", M="medium", L="large" }
          class A {
              t: string = ""
              getType(): string {
                  return this.t
              }
              constructor(p: Color) { this.t = "Color" }
              constructor(p: Size) { this.t = "Size" }
              constructor(p: int) { this.t = "int" }
              constructor(p: string) { this.t = "string" }
              constructor(p: short) { this.t = "short" }
          }
      use: |-
          arktest.assertEQ(new A(-1).getType(), "int")
          arktest.assertEQ(new A(-2 as short).getType(), "int")
          arktest.assertEQ(new A(-3 as byte).getType(), "int")
          arktest.assertEQ(new A(Color.Red).getType(), "Color")
          arktest.assertEQ(new A("abc").getType(), "string")
          arktest.assertEQ(new A(Size.L).getType(), "Size")

    - decl: |-
          // arrays
          enum Color { Red, Green = 82, Blue }
          enum Size { S="small", M="medium", L="large" }
          class A {
              t: string = ""
              getType(): string {
                  return this.t
              }
              constructor() {}
              constructor(p: FixedArray<A>) { this.t = "A" }
              constructor(p: FixedArray<Color>) { this.t = "Color" }
              constructor(p: FixedArray<Size>) { this.t = "Size" }
              constructor(p: FixedArray<Byte>) { this.t = "Byte" }
              constructor(p: FixedArray<Short>) { this.t = "Short" }
              constructor(p: FixedArray<Int>) { this.t = "Int" }
              constructor(p: FixedArray<Long>) { this.t = "Long" }
              constructor(p: FixedArray<Char>) { this.t = "Char" }
              constructor(p: FixedArray<Boolean>) { this.t = "Boolean" }
              constructor(p: FixedArray<Float>) { this.t = "Float" }
              constructor(p: FixedArray<Double>) { this.t = "Double" }
              constructor(p: FixedArray<Object>) { this.t = "Object" }
          }
      use: |-
          arktest.assertEQ(new A([(-1).toByte()]).getType(), "Byte")
          arktest.assertEQ(new A([(-1).toShort()]).getType(), "Short")
          arktest.assertEQ(new A([(-1).toInt()]).getType(), "Int")
          arktest.assertEQ(new A([(-1).toLong()]).getType(), "Long")
          arktest.assertEQ(new A([c'A']).getType(), "Char")
          arktest.assertEQ(new A([false]).getType(), "Boolean")
          arktest.assertEQ(new A([3.14f]).getType(), "Float")
          arktest.assertEQ(new A([3.14]).getType(), "Double")
          arktest.assertEQ(new A([new Byte((-1).toByte())]).getType(), "Byte")
          arktest.assertEQ(new A([new Short((-1).toShort())]).getType(), "Short")
          arktest.assertEQ(new A([new Int(-1)]).getType(), "Int")
          arktest.assertEQ(new A([new Long((-1).toLong())]).getType(), "Long")
          arktest.assertEQ(new A([new Char(c'A')]).getType(), "Char")
          arktest.assertEQ(new A([new Boolean(false)]).getType(), "Boolean")
          arktest.assertEQ(new A([new Float(3.14f)]).getType(), "Float")
          arktest.assertEQ(new A([new Double(3.14)]).getType(), "Double")
          arktest.assertEQ(new A([new Object()]).getType(), "Object")
          arktest.assertEQ(new A([Color.Red]).getType(), "Color")
          arktest.assertEQ(new A([Size.M]).getType(), "Size")
          arktest.assertEQ(new A(new A[1]).getType(), "A")

    - decl: |-
          // unions
          type USN = string | number
          type USB = string | Boolean
          class A {
              t: string = ""
              getType(): string {
                  return this.t
              }
              constructor() {}
              constructor(p: USN) { this.t = "USN" }
              constructor(p: USB) { this.t = "USB" }
              constructor(p: string) { this.t = "string" }
              constructor(p: number) { this.t = "number" }
              constructor(p: Boolean) { this.t = "Boolean" }
          }
      use: |-
          arktest.assertEQ(new A(new Boolean(false)).getType(), "USB")
          arktest.assertEQ(new A("").getType(), "USN")
          arktest.assertEQ(new A(1.0).getType(), "USN")
          let usn: USN = "abc"
          arktest.assertEQ(new A(usn).getType(), "USN")
          usn = 42.0
          arktest.assertEQ(new A(usn).getType(), "USN")
          let usb: USB = new Boolean(true)
          arktest.assertEQ(new A(usb).getType(), "USB")
          usn = "xyz"
          arktest.assertEQ(new A(usn).getType(), "USN")

    - decl: |-
          // constructor overloaded with multiple parameters with different types
          class A {
              i: int
              d: double
              s: string = ""
              constructor() {}
              constructor(i: int) { this.i = i }
              constructor(i: int, j: int) { this.i = i + j }
              constructor(i: int, j: int, k: int) { this.i = 3 }
              constructor(i: int, j: double) { this.d = j + i }
              constructor(i: int, j: int, k: double) { this.d = 123.0 }
              constructor(i: double, j: double, k: int) { this.d = i + j + k }
              constructor(i: string, j: double) { this.s = i + j }
          }
      use: |-
          let a: A = new A()
          arktest.assertEQ(a.i, 0)
          arktest.assertEQ(a.d, 0.0)
          arktest.assertEQ(a.s, "")
          a = new A(12345)
          arktest.assertEQ(a.i, 12345)
          arktest.assertEQ(a.d, 0.0)
          arktest.assertEQ(a.s, "")
          a = new A(11, 22)
          arktest.assertEQ(a.i, 33)
          arktest.assertEQ(a.d, 0.0)
          arktest.assertEQ(a.s, "")
          a = new A(1, 2, 3)
          arktest.assertEQ(a.i, 3)
          arktest.assertEQ(a.d, 0.0)
          arktest.assertEQ(a.s, "")
          a = new A(90, 90.0)
          arktest.assertEQ(a.i, 0)
          arktest.assertEQ(a.d, 180.0)
          arktest.assertEQ(a.s, "")
          a = new A(0, 0, 0.0)
          arktest.assertEQ(a.i, 0)
          arktest.assertEQ(a.d, 123.0)
          arktest.assertEQ(a.s, "")
          a = new A(1.0, -1.0, 42)
          arktest.assertEQ(a.i, 0)
          arktest.assertEQ(a.d, 42.0)
          arktest.assertEQ(a.s, "")
          a = new A("", 0.00014)
          arktest.assertEQ(a.i, 0)
          arktest.assertEQ(a.d, 0.0)
          arktest.assertEQ(a.s, "0.00014")

    - decl: |-
          // constructor overloaded with boxing/unboxing parameters
          class A {
              fld: number
              constructor(a: boolean) { this.fld = 1.0 }
              constructor(a: Boolean, b: Number) { this.fld = 5.0 }
          }
      use: |-
          let a = new A(true)
          arktest.assertEQ(a.fld,  1.0)
          a = new A(new Boolean())
          arktest.assertEQ(a.fld, 1.0)
          a = new A(true, 1.0)
          arktest.assertEQ(a.fld, 5.0)
          a = new A(false, new Double())
          arktest.assertEQ(a.fld, 5.0)
          a = new A(new Boolean(), new Double())
          arktest.assertEQ(a.fld, 5.0)

    - decl: |-
          // constructor overloaded with type variables
          class X {}
          class Y {}
          class A<T, U> {
              fld: int
              constructor(a: T) { this.fld =  1 }
              constructor(a: T, b: U) { this.fld =  2 }
              constructor(a: U, b: T, c: U) { this.fld =  3 }
          }
      use: |-
          let a: A<X, Y> = new A<X, Y>(new X())
          arktest.assertEQ(a.fld, 1)
          a = new A<X, Y>(new X(), new Y())
          arktest.assertEQ(a.fld, 2)
          a = new A<X, Y>(new Y(), new X(), new Y())
          arktest.assertEQ(a.fld, 3)

    - decl: |-
          // constructor overloaded with multiple parameters with dependent types
          class X {}
          class Y extends X {}
          class Z extends Y {}
          class A {
              fld: int
              constructor(a: X, b: Y, c: Z) { this.fld =  1 }
              constructor(a: X, b: Y) { this.fld =  2 }
              constructor(a: X) { this.fld =  3 }
          }
      use: |-
          let x: X = new X()
          let y: Y = new Y()
          let z: Z = new Z()
          let a: A = new A(x)
          arktest.assertEQ(a.fld, 3)
          a = new A(y)
          arktest.assertEQ(a.fld, 3)
          a = new A(z)
          arktest.assertEQ(a.fld, 3)
          a = new A(x, y)
          arktest.assertEQ(a.fld, 2)
          a = new A(z, z)
          arktest.assertEQ(a.fld, 2)
          a = new A(x, y, z)
          arktest.assertEQ(a.fld, 1)
          a = new A(z, z, z)
          arktest.assertEQ(a.fld, 1)
